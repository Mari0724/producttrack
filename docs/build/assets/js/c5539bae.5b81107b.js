"use strict";(self.webpackChunkdocs_web=self.webpackChunkdocs_web||[]).push([[768],{1860:(i,e,n)=>{n.r(e),n.d(e,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>c,toc:()=>t});const c=JSON.parse('{"id":"backend/services/notificaciones/notificar.Stockbajo","title":"Notificar Stock Bajo","description":"Este m\xf3dulo define la funci\xf3n notificarStockBajo, que consulta los recordatorios pendientes de productos con bajo inventario. Si se cumple la condici\xf3n de cantidad m\xednima, genera notificaciones para todos los miembros de la empresa asociada, evitando notificar a usuarios individuales.","source":"@site/docs/backend/services/notificaciones/notificar.StockBajo.md","sourceDirName":"backend/services/notificaciones","slug":"/backend/services/notificaciones/notificar.Stockbajo","permalink":"/docs/backend/services/notificaciones/notificar.Stockbajo","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/backend/services/notificaciones/notificar.StockBajo.md","tags":[],"version":"current","frontMatter":{"id":"notificar.Stockbajo","title":"Notificar Stock Bajo","sidebar_label":"Notificaci\xf3n de stock bajo"},"sidebar":"tutorialSidebar","previous":{"title":"Notificaci\xf3n de productos vencidos","permalink":"/docs/backend/services/notificaciones/notificar-producto-vencido"},"next":{"title":"Notificar Actualizaci\xf3n App","permalink":"/docs/backend/services/notificaciones/notificarActualizacion"}}');var o=n(4848),s=n(8453);const a={id:"notificar.Stockbajo",title:"Notificar Stock Bajo",sidebar_label:"Notificaci\xf3n de stock bajo"},r="Notificaci\xf3n de Stock Bajo",d={},t=[{value:"\ud83d\udd0d Ubicaci\xf3n",id:"-ubicaci\xf3n",level:2},{value:"\ud83d\udd14 Funci\xf3n: notificarStockBajo",id:"-funci\xf3n-notificarstockbajo",level:2},{value:"\u2705 Prop\xf3sito:",id:"-prop\xf3sito",level:4},{value:"\ud83d\udd0d Comportamiento:",id:"-comportamiento",level:2},{value:"\ud83d\udce4 Estructura de notificaci\xf3n",id:"-estructura-de-notificaci\xf3n",level:3},{value:"\u26a0\ufe0f Condiciones clave:",id:"\ufe0f-condiciones-clave",level:2},{value:"\ud83d\udce6 Dependencias:",id:"-dependencias",level:2}];function l(i){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...i.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"notificaci\xf3n-de-stock-bajo",children:"Notificaci\xf3n de Stock Bajo"})}),"\n",(0,o.jsxs)(e.p,{children:["Este m\xf3dulo define la funci\xf3n ",(0,o.jsx)(e.code,{children:"notificarStockBajo"}),", que consulta los recordatorios pendientes de productos con bajo inventario. Si se cumple la condici\xf3n de cantidad m\xednima, genera notificaciones para todos los miembros de la empresa asociada, evitando notificar a usuarios individuales."]}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h2,{id:"-ubicaci\xf3n",children:"\ud83d\udd0d Ubicaci\xf3n"}),"\n",(0,o.jsx)(e.p,{children:"src/services/notificaciones/notificar.StockBajo.ts"}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h2,{id:"-funci\xf3n-notificarstockbajo",children:"\ud83d\udd14 Funci\xf3n: notificarStockBajo"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-ts",children:"export async function notificarStockBajo(): Promise<void>\n"})}),"\n",(0,o.jsx)(e.h4,{id:"-prop\xf3sito",children:"\u2705 Prop\xf3sito:"}),"\n",(0,o.jsx)(e.p,{children:"Enviar notificaciones autom\xe1ticas cuando un producto alcanza una cantidad menor o igual a su m\xednimo definido."}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h2,{id:"-comportamiento",children:"\ud83d\udd0d Comportamiento:"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:["Consulta los recordatorios con estado ",(0,o.jsx)(e.code,{children:"PENDIENTE"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"Verifica si el producto relacionado tiene una cantidad menor o igual al m\xednimo configurado."}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"Si el producto pertenece a un usuario empresarial:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"Obtiene todos los usuarios relacionados con esa empresa."}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"Crea una notificaci\xf3n para cada uno."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:["Cambia el estado del recordatorio a ",(0,o.jsx)(e.code,{children:"ENVIADO"})," para evitar duplicidad."]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"Omite notificar a usuarios individuales."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h3,{id:"-estructura-de-notificaci\xf3n",children:"\ud83d\udce4 Estructura de notificaci\xf3n"}),"\n",(0,o.jsxs)(e.table,{children:[(0,o.jsx)(e.thead,{children:(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.th,{children:"Campo"}),(0,o.jsx)(e.th,{children:"Tipo / Formato"}),(0,o.jsx)(e.th,{children:"Descripci\xf3n"})]})}),(0,o.jsxs)(e.tbody,{children:[(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.td,{children:(0,o.jsx)(e.code,{children:"tipo"})}),(0,o.jsxs)(e.td,{children:["Enum (",(0,o.jsx)(e.code,{children:"TipoNotificacion.STOCK_BAJO"}),")"]}),(0,o.jsx)(e.td,{children:"Tipo de notificaci\xf3n que se est\xe1 enviando."})]}),(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.td,{children:(0,o.jsx)(e.code,{children:"titulo"})}),(0,o.jsx)(e.td,{children:(0,o.jsx)(e.code,{children:"string"})}),(0,o.jsxs)(e.td,{children:["T\xedtulo de la notificaci\xf3n. Ejemplo: ",(0,o.jsx)(e.code,{children:'"Stock bajo: [nombre del producto]"'}),"."]})]}),(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.td,{children:(0,o.jsx)(e.code,{children:"mensaje"})}),(0,o.jsx)(e.td,{children:(0,o.jsx)(e.code,{children:"string"})}),(0,o.jsxs)(e.td,{children:["Cuerpo del mensaje. Ejemplo: ",(0,o.jsx)(e.code,{children:"\"El producto '[nombre]' tiene solo [cantidad] unidades disponibles.\""})]})]}),(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.td,{children:(0,o.jsx)(e.code,{children:"idUsuario"})}),(0,o.jsxs)(e.td,{children:[(0,o.jsx)(e.code,{children:"string"})," / UUID"]}),(0,o.jsx)(e.td,{children:"ID del usuario empresarial que recibir\xe1 la notificaci\xf3n."})]})]})]}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h2,{id:"\ufe0f-condiciones-clave",children:"\u26a0\ufe0f Condiciones clave:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"Solo se notifica a usuarios empresariales."}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"Si el stock est\xe1 por encima del m\xednimo, no se env\xeda nada."}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:["El recordatorio se marca como ",(0,o.jsx)(e.code,{children:"ENVIADO"})," despu\xe9s de generar las notificaciones."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h2,{id:"-dependencias",children:"\ud83d\udce6 Dependencias:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.code,{children:"@prisma/client"}),": para acceso a la base de datos y enums como ",(0,o.jsx)(e.code,{children:"TipoNotificacion"})," y ",(0,o.jsx)(e.code,{children:"EstadoRecordatorio"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.code,{children:"prismaClient"}),": instancia personalizada del cliente Prisma (",(0,o.jsx)(e.code,{children:"src/utils/prismaClient"}),")."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.hr,{})]})}function h(i={}){const{wrapper:e}={...(0,s.R)(),...i.components};return e?(0,o.jsx)(e,{...i,children:(0,o.jsx)(l,{...i})}):l(i)}},8453:(i,e,n)=>{n.d(e,{R:()=>a,x:()=>r});var c=n(6540);const o={},s=c.createContext(o);function a(i){const e=c.useContext(s);return c.useMemo((function(){return"function"==typeof i?i(e):{...e,...i}}),[e,i])}function r(i){let e;return e=i.disableParentContext?"function"==typeof i.components?i.components(o):i.components||o:a(i.components),c.createElement(s.Provider,{value:e},i.children)}}}]);