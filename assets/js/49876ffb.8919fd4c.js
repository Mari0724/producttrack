"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8777],{5433:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>a,contentTitle:()=>s,default:()=>u,frontMatter:()=>c,metadata:()=>d,toc:()=>l});const d=JSON.parse('{"id":"backend/services/productos-service","title":"Servicio de Productos","description":"Este servicio gestiona todas las operaciones relacionadas con productos: creaci\xf3n, actualizaci\xf3n, eliminaci\xf3n, b\xfasqueda, categorizaci\xf3n, estad\xedsticas y gesti\xf3n de im\xe1genes.","source":"@site/docs/backend/services/productos.service.md","sourceDirName":"backend/services","slug":"/backend/services/productos-service","permalink":"/producttrack/docs/backend/services/productos-service","draft":false,"unlisted":false,"editUrl":"https://github.com/Mari0724/producttrack/docs/backend/services/productos.service.md","tags":[],"version":"current","frontMatter":{"id":"productos-service","title":"Servicio de Productos","sidebar_label":"Productos"},"sidebar":"tutorialSidebar","previous":{"title":"Preferencias","permalink":"/producttrack/docs/backend/services/preferencias-service"},"next":{"title":"Token","permalink":"/producttrack/docs/backend/services/token.service"}}');var r=n(4848),o=n(8453);const c={id:"productos-service",title:"Servicio de Productos",sidebar_label:"Productos"},s=void 0,a={},l=[{value:"\ud83d\udd0d  Ubicaci\xf3n",id:"--ubicaci\xf3n",level:2},{value:"\ud83d\udce6 Dependencias",id:"-dependencias",level:2},{value:"\ud83d\udd04 Funciones",id:"-funciones",level:2},{value:"1\ufe0f\u20e3 <code>getAllProductos(filters)</code>",id:"1\ufe0f\u20e3-getallproductosfilters",level:3},{value:"2\ufe0f\u20e3 <code>getProductoById(id)</code>",id:"2\ufe0f\u20e3-getproductobyidid",level:3},{value:"3\ufe0f\u20e3 <code>getCategoriasUnicas(tipoUsuario)</code>",id:"3\ufe0f\u20e3-getcategoriasunicastipousuario",level:3},{value:"4\ufe0f\u20e3 <code>getCantidadPorCategoria()</code>",id:"4\ufe0f\u20e3-getcantidadporcategoria",level:3},{value:"5\ufe0f\u20e3 <code>getProductosPorCategoria(categoria)</code>",id:"5\ufe0f\u20e3-getproductosporcategoriacategoria",level:3},{value:"6\ufe0f\u20e3 <code>obtenerNombresProductosUsuario(idUsuario)</code>",id:"6\ufe0f\u20e3-obtenernombresproductosusuarioidusuario",level:3},{value:"7\ufe0f\u20e3 <code>getCantidadPorRangoPrecio()</code>",id:"7\ufe0f\u20e3-getcantidadporrangoprecio",level:3},{value:"8\ufe0f\u20e3 <code>subirImagenCloudinary(imagenBase64)</code>",id:"8\ufe0f\u20e3-subirimagencloudinaryimagenbase64",level:3},{value:"9\ufe0f\u20e3 <code>createProducto(data: ProductosDTO)</code>",id:"9\ufe0f\u20e3-createproductodata-productosdto",level:3},{value:"\ud83d\udd1f <code>updateProducto(id, data)</code>",id:"-updateproductoid-data",level:3},{value:"1\ufe0f\u20e31\ufe0f\u20e3 <code>obtenerProductoPorId(id)</code>",id:"1\ufe0f\u20e31\ufe0f\u20e3-obtenerproductoporidid",level:3},{value:"1\ufe0f\u20e32\ufe0f\u20e3 <code>deleteProducto(id)</code>",id:"1\ufe0f\u20e32\ufe0f\u20e3-deleteproductoid",level:3},{value:"\ud83d\udcc2 Tablas relacionadas",id:"-tablas-relacionadas",level:2},{value:"\ud83d\udca1 Ejemplo de uso",id:"-ejemplo-de-uso",level:2}];function t(e){const i={code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.p,{children:"Este servicio gestiona todas las operaciones relacionadas con productos: creaci\xf3n, actualizaci\xf3n, eliminaci\xf3n, b\xfasqueda, categorizaci\xf3n, estad\xedsticas y gesti\xf3n de im\xe1genes."}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"--ubicaci\xf3n",children:"\ud83d\udd0d  Ubicaci\xf3n"}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.code,{children:"src/services/productos.service.ts"})}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"-dependencias",children:"\ud83d\udce6 Dependencias"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-ts",children:"import prisma from '../utils/prismaClient';\r\nimport { ProductosDTO } from '../models/ProductosDTO';\r\nimport { EstadoProducto, TipoUsuario } from '@prisma/client';\r\nimport { v2 as cloudinary } from 'cloudinary';\n"})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.code,{children:"prisma"})})," \u2192 Cliente para interactuar con la base de datos."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.code,{children:"ProductosDTO"})})," \u2192 Definici\xf3n del DTO para productos."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.code,{children:"EstadoProducto"})})," y ",(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.code,{children:"TipoUsuario"})})," \u2192 Tipos de Prisma."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.code,{children:"cloudinary"})})," \u2192 Servicio de almacenamiento de im\xe1genes."]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"-funciones",children:"\ud83d\udd04 Funciones"}),"\n",(0,r.jsxs)(i.h3,{id:"1\ufe0f\u20e3-getallproductosfilters",children:["1\ufe0f\u20e3 ",(0,r.jsx)(i.code,{children:"getAllProductos(filters)"})]}),"\n",(0,r.jsx)(i.p,{children:"Obtiene la lista de productos aplicando m\xfaltiples filtros opcionales:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"productoId"}),", ",(0,r.jsx)(i.code,{children:"nombre"}),", ",(0,r.jsx)(i.code,{children:"categoria"}),", ",(0,r.jsx)(i.code,{children:"estado"}),", ",(0,r.jsx)(i.code,{children:"usuarioId"})]}),"\n",(0,r.jsxs)(i.li,{children:["Rango de ",(0,r.jsx)(i.code,{children:"fechaAdquisicion"})," y ",(0,r.jsx)(i.code,{children:"fechaVencimiento"})]}),"\n",(0,r.jsxs)(i.li,{children:["Por defecto excluye productos con estado ",(0,r.jsx)(i.code,{children:'"ELIMINADO"'})]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsxs)(i.h3,{id:"2\ufe0f\u20e3-getproductobyidid",children:["2\ufe0f\u20e3 ",(0,r.jsx)(i.code,{children:"getProductoById(id)"})]}),"\n",(0,r.jsx)(i.p,{children:"Obtiene un producto espec\xedfico por su ID."}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsxs)(i.h3,{id:"3\ufe0f\u20e3-getcategoriasunicastipousuario",children:["3\ufe0f\u20e3 ",(0,r.jsx)(i.code,{children:"getCategoriasUnicas(tipoUsuario)"})]}),"\n",(0,r.jsxs)(i.p,{children:["Devuelve las categor\xedas \xfanicas de productos seg\xfan el tipo de usuario (",(0,r.jsx)(i.code,{children:"INDIVIDUAL"})," o ",(0,r.jsx)(i.code,{children:"EMPRESARIAL"}),")."]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsxs)(i.h3,{id:"4\ufe0f\u20e3-getcantidadporcategoria",children:["4\ufe0f\u20e3 ",(0,r.jsx)(i.code,{children:"getCantidadPorCategoria()"})]}),"\n",(0,r.jsx)(i.p,{children:"Agrupa productos por categor\xeda y devuelve la cantidad de productos en cada una."}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsxs)(i.h3,{id:"5\ufe0f\u20e3-getproductosporcategoriacategoria",children:["5\ufe0f\u20e3 ",(0,r.jsx)(i.code,{children:"getProductosPorCategoria(categoria)"})]}),"\n",(0,r.jsx)(i.p,{children:"Devuelve los productos que pertenecen a una categor\xeda espec\xedfica (b\xfasqueda insensible a may\xfasculas/min\xfasculas)."}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsxs)(i.h3,{id:"6\ufe0f\u20e3-obtenernombresproductosusuarioidusuario",children:["6\ufe0f\u20e3 ",(0,r.jsx)(i.code,{children:"obtenerNombresProductosUsuario(idUsuario)"})]}),"\n",(0,r.jsx)(i.p,{children:"Devuelve un arreglo con los nombres de todos los productos activos de un usuario."}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsxs)(i.h3,{id:"7\ufe0f\u20e3-getcantidadporrangoprecio",children:["7\ufe0f\u20e3 ",(0,r.jsx)(i.code,{children:"getCantidadPorRangoPrecio()"})]}),"\n",(0,r.jsx)(i.p,{children:"Clasifica y cuenta los productos en rangos de precio:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Menos de 50 mil"}),"\n",(0,r.jsx)(i.li,{children:"50 mil \u2013 100 mil"}),"\n",(0,r.jsx)(i.li,{children:"100 mil \u2013 200 mil"}),"\n",(0,r.jsx)(i.li,{children:"M\xe1s de 200 mil"}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsxs)(i.h3,{id:"8\ufe0f\u20e3-subirimagencloudinaryimagenbase64",children:["8\ufe0f\u20e3 ",(0,r.jsx)(i.code,{children:"subirImagenCloudinary(imagenBase64)"})]}),"\n",(0,r.jsx)(i.p,{children:"Sube una imagen codificada en base64 a Cloudinary y devuelve la URL segura."}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsxs)(i.h3,{id:"9\ufe0f\u20e3-createproductodata-productosdto",children:["9\ufe0f\u20e3 ",(0,r.jsx)(i.code,{children:"createProducto(data: ProductosDTO)"})]}),"\n",(0,r.jsx)(i.p,{children:"Crea un nuevo producto:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["Convierte fechas a formato ",(0,r.jsx)(i.code,{children:"Date"})]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsx)(i.p,{children:"Crea recordatorio de stock m\xednimo seg\xfan tipo de usuario:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"INDIVIDUAL"})," \u2192 ",(0,r.jsx)(i.code,{children:"cantidadMinima = 2"})]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"EMPRESARIAL"})," \u2192 ",(0,r.jsx)(i.code,{children:"cantidadMinima = 30"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsxs)(i.h3,{id:"-updateproductoid-data",children:["\ud83d\udd1f ",(0,r.jsx)(i.code,{children:"updateProducto(id, data)"})]}),"\n",(0,r.jsx)(i.p,{children:"Actualiza un producto:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Si la imagen cambia, reemplaza la anterior en Cloudinary."}),"\n",(0,r.jsx)(i.li,{children:"Actualiza solo los campos enviados."}),"\n",(0,r.jsxs)(i.li,{children:["Registra ",(0,r.jsx)(i.code,{children:"updatedAt"}),"."]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsxs)(i.h3,{id:"1\ufe0f\u20e31\ufe0f\u20e3-obtenerproductoporidid",children:["1\ufe0f\u20e31\ufe0f\u20e3 ",(0,r.jsx)(i.code,{children:"obtenerProductoPorId(id)"})]}),"\n",(0,r.jsx)(i.p,{children:"Obtiene un producto incluyendo su informaci\xf3n de usuario (\xfatil para validaciones)."}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsxs)(i.h3,{id:"1\ufe0f\u20e32\ufe0f\u20e3-deleteproductoid",children:["1\ufe0f\u20e32\ufe0f\u20e3 ",(0,r.jsx)(i.code,{children:"deleteProducto(id)"})]}),"\n",(0,r.jsx)(i.p,{children:"Elimina l\xf3gicamente un producto:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Borra su imagen en Cloudinary si existe."}),"\n",(0,r.jsxs)(i.li,{children:["Cambia su ",(0,r.jsx)(i.code,{children:"estado"})," a ",(0,r.jsx)(i.code,{children:'"ELIMINADO"'})," y registra ",(0,r.jsx)(i.code,{children:"eliminadoEn"}),"."]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"-tablas-relacionadas",children:"\ud83d\udcc2 Tablas relacionadas"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.code,{children:"productos"})})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"id"}),", ",(0,r.jsx)(i.code,{children:"nombre"}),", ",(0,r.jsx)(i.code,{children:"descripcion"}),", ",(0,r.jsx)(i.code,{children:"precio"}),", ",(0,r.jsx)(i.code,{children:"cantidad"}),", ",(0,r.jsx)(i.code,{children:"fechaAdquisicion"}),", ",(0,r.jsx)(i.code,{children:"fechaVencimiento"}),", ",(0,r.jsx)(i.code,{children:"usuarioId"}),", ",(0,r.jsx)(i.code,{children:"estado"}),", ",(0,r.jsx)(i.code,{children:"imagen"}),", ",(0,r.jsx)(i.code,{children:"categoria"}),", ",(0,r.jsx)(i.code,{children:"codigoBarras"}),", ",(0,r.jsx)(i.code,{children:"codigoQR"}),", ",(0,r.jsx)(i.code,{children:"eliminadoEn"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.code,{children:"users"})})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"idUsuario"}),", ",(0,r.jsx)(i.code,{children:"tipoUsuario"}),", ",(0,r.jsx)(i.code,{children:"empresaId"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.code,{children:"recorStock"})})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"productoId"}),", ",(0,r.jsx)(i.code,{children:"cantidadMinima"}),", ",(0,r.jsx)(i.code,{children:"estado"}),", ",(0,r.jsx)(i.code,{children:"fechaRecordatorio"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"-ejemplo-de-uso",children:"\ud83d\udca1 Ejemplo de uso"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-ts",children:'// Obtener productos filtrados por nombre y estado\r\nconst productos = await getAllProductos({\r\n  nombre: "laptop",\r\n  estado: "DISPONIBLE"\r\n});\r\n\r\n// Crear un producto nuevo\r\nconst nuevo = await createProducto({\r\n  nombre: "Monitor 24\'\'",\r\n  descripcion: "Full HD IPS",\r\n  cantidad: 10,\r\n  precio: 350000,\r\n  fechaAdquisicion: "2025-08-01",\r\n  fechaVencimiento: "2026-08-01",\r\n  usuarioId: 7,\r\n  estado: "DISPONIBLE",\r\n  categoria: "Electr\xf3nica",\r\n  imagen: "data:image/png;base64,..."\r\n});\n'})}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsxs)(i.p,{children:["\ud83d\udccc ",(0,r.jsx)(i.strong,{children:"Notas"}),":"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Todas las funciones que interact\xfaan con la base de datos son as\xedncronas."}),"\n",(0,r.jsxs)(i.li,{children:["Las im\xe1genes se manejan exclusivamente mediante ",(0,r.jsx)(i.strong,{children:"Cloudinary"}),"."]}),"\n",(0,r.jsxs)(i.li,{children:["Las eliminaciones son ",(0,r.jsx)(i.strong,{children:"l\xf3gicas"})," para mantener el historial y trazabilidad."]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{})]})}function u(e={}){const{wrapper:i}={...(0,o.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>c,x:()=>s});var d=n(6540);const r={},o=d.createContext(r);function c(e){const i=d.useContext(o);return d.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function s(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),d.createElement(o.Provider,{value:i},e.children)}}}]);