"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6762],{3434:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>t,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"backend/services/norificaciones/actualizacion.service","title":"Servicio de Notificaciones de Actualizaci\xf3n","description":"Este servicio se encarga de enviar notificaciones de tipo ACTUALIZACION_APP a todos los usuarios registrados que tengan habilitadas las preferencias correspondientes.","source":"@site/docs/backend/services/norificaciones/actualizacion.service.md","sourceDirName":"backend/services/norificaciones","slug":"/backend/services/norificaciones/actualizacion.service","permalink":"/producttrack/docs/backend/services/norificaciones/actualizacion.service","draft":false,"unlisted":false,"editUrl":"https://github.com/Mari0724/producttrack/docs/backend/services/norificaciones/actualizacion.service.md","tags":[],"version":"current","frontMatter":{"id":"actualizacion.service","title":"Servicio de Notificaciones de Actualizaci\xf3n","sidebar_label":"Actualizaci\xf3n"},"sidebar":"tutorialSidebar","previous":{"title":"Log","permalink":"/producttrack/docs/backend/services/log.service"},"next":{"title":"Comentario Producto","permalink":"/producttrack/docs/backend/services/norificaciones/comentarioProductos.service"}}');var c=n(4848),a=n(8453);const r={id:"actualizacion.service",title:"Servicio de Notificaciones de Actualizaci\xf3n",sidebar_label:"Actualizaci\xf3n"},o=void 0,t={},d=[{value:"\ud83d\udd0d Ubicaci\xf3n",id:"-ubicaci\xf3n",level:2},{value:"\ud83d\udce6 Dependencias",id:"-dependencias",level:2},{value:"\ud83d\udcdc Funciones",id:"-funciones",level:2},{value:"1. <code>notificarActualizacionApp(titulo: string, mensaje: string)</code>",id:"1-notificaractualizacionapptitulo-string-mensaje-string",level:3},{value:"\ud83e\udde0 Observaciones",id:"-observaciones",level:2}];function l(e){const i={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(i.p,{children:["Este servicio se encarga de ",(0,c.jsxs)(i.strong,{children:["enviar notificaciones de tipo ",(0,c.jsx)(i.code,{children:"ACTUALIZACION_APP"})]})," a todos los usuarios registrados que tengan habilitadas las preferencias correspondientes."]}),"\n",(0,c.jsx)(i.hr,{}),"\n",(0,c.jsx)(i.h2,{id:"-ubicaci\xf3n",children:"\ud83d\udd0d Ubicaci\xf3n"}),"\n",(0,c.jsx)(i.p,{children:(0,c.jsx)(i.code,{children:"src/services/notificaciones/actualizacion.service.ts"})}),"\n",(0,c.jsx)(i.hr,{}),"\n",(0,c.jsx)(i.h2,{id:"-dependencias",children:"\ud83d\udce6 Dependencias"}),"\n",(0,c.jsxs)(i.ul,{children:["\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.a,{href:"/producttrack/docs/backend/utils/prismaClient",children:(0,c.jsx)(i.code,{children:"prisma"})}),"\u2014 Cliente de base de datos para manejar usuarios y notificaciones."]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.a,{href:"https://www.prisma.io/docs",children:(0,c.jsx)(i.code,{children:"TipoNotificacion"})})," \u2014 Enumeraci\xf3n generada por Prisma que define los tipos de notificaci\xf3n."]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.a,{href:"../../utils/notificaciones/preferenciasNotificaciones",children:(0,c.jsx)(i.code,{children:"puedeNotificar"})})," \u2014 Funci\xf3n auxiliar que valida si un usuario tiene habilitado recibir un tipo de notificaci\xf3n espec\xedfico."]}),"\n"]}),"\n",(0,c.jsx)(i.hr,{}),"\n",(0,c.jsx)(i.h2,{id:"-funciones",children:"\ud83d\udcdc Funciones"}),"\n",(0,c.jsxs)(i.h3,{id:"1-notificaractualizacionapptitulo-string-mensaje-string",children:["1. ",(0,c.jsx)(i.code,{children:"notificarActualizacionApp(titulo: string, mensaje: string)"})]}),"\n",(0,c.jsxs)(i.p,{children:["Env\xeda una notificaci\xf3n de tipo ",(0,c.jsx)(i.code,{children:"ACTUALIZACION_APP"})," a todos los usuarios activos (no eliminados) que tengan habilitada esta preferencia."]}),"\n",(0,c.jsx)(i.p,{children:(0,c.jsx)(i.strong,{children:"Par\xe1metros:"})}),"\n",(0,c.jsxs)(i.ul,{children:["\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"titulo"}),": Texto que ser\xe1 el t\xedtulo de la notificaci\xf3n."]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"mensaje"}),": Contenido principal de la notificaci\xf3n."]}),"\n"]}),"\n",(0,c.jsx)(i.p,{children:(0,c.jsx)(i.strong,{children:"Flujo de ejecuci\xf3n:"})}),"\n",(0,c.jsxs)(i.ol,{children:["\n",(0,c.jsxs)(i.li,{children:["Obtiene todos los usuarios cuyo ",(0,c.jsx)(i.code,{children:"deletedAt"})," sea ",(0,c.jsx)(i.code,{children:"null"})," (soft delete)."]}),"\n",(0,c.jsx)(i.li,{children:"Si no hay usuarios, muestra una advertencia y finaliza."}),"\n",(0,c.jsxs)(i.li,{children:["Itera sobre cada usuario y verifica, usando ",(0,c.jsx)(i.code,{children:"puedeNotificar"}),", si este puede recibir notificaciones de tipo ",(0,c.jsx)(i.code,{children:"ACTUALIZACION_APP"}),"."]}),"\n",(0,c.jsx)(i.li,{children:"Crea un arreglo con las notificaciones a enviar."}),"\n",(0,c.jsxs)(i.li,{children:["Inserta todas las notificaciones en la base de datos mediante ",(0,c.jsx)(i.code,{children:"createMany"})," si hay alguna pendiente."]}),"\n"]}),"\n",(0,c.jsx)(i.p,{children:(0,c.jsx)(i.strong,{children:"Estructura de la notificaci\xf3n generada:"})}),"\n",(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{className:"language-ts",children:"{\r\n  idUsuario: number;\r\n  tipo: TipoNotificacion.ACTUALIZACION_APP;\r\n  titulo: string;\r\n  mensaje: string;\r\n  leida: false;\r\n}\n"})}),"\n",(0,c.jsx)(i.p,{children:(0,c.jsx)(i.strong,{children:"Retorno:"})}),"\n",(0,c.jsxs)(i.ul,{children:["\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"Promise<void>"})," \u2014 No retorna datos, pero crea registros en la tabla de notificaciones."]}),"\n"]}),"\n",(0,c.jsx)(i.hr,{}),"\n",(0,c.jsx)(i.h2,{id:"-observaciones",children:"\ud83e\udde0 Observaciones"}),"\n",(0,c.jsxs)(i.ul,{children:["\n",(0,c.jsxs)(i.li,{children:["Este servicio ",(0,c.jsx)(i.strong,{children:"respeta las preferencias de notificaci\xf3n"})," del usuario mediante ",(0,c.jsx)(i.code,{children:"puedeNotificar"}),"."]}),"\n",(0,c.jsxs)(i.li,{children:["Utiliza ",(0,c.jsx)(i.strong,{children:"soft delete"})," para determinar usuarios activos (",(0,c.jsx)(i.code,{children:"deletedAt: null"}),")."]}),"\n",(0,c.jsxs)(i.li,{children:["Agrupa las inserciones en una sola operaci\xf3n (",(0,c.jsx)(i.code,{children:"createMany"}),") para mejorar el rendimiento."]}),"\n"]}),"\n",(0,c.jsx)(i.hr,{})]})}function u(e={}){const{wrapper:i}={...(0,a.R)(),...e.components};return i?(0,c.jsx)(i,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>r,x:()=>o});var s=n(6540);const c={},a=s.createContext(c);function r(e){const i=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:r(e.components),s.createElement(a.Provider,{value:i},e.children)}}}]);