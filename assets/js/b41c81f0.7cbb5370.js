"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6990],{5369:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"backend/controllers/notificaciones.controller","title":"NotificacionesController","description":"Este controlador gestiona el env\xedo y configuraci\xf3n de notificaciones para los usuarios. Las notificaciones cubren eventos como bajo stock, vencimiento de productos, comentarios, recomendaciones de reposici\xf3n y actualizaciones de la app.","source":"@site/docs/backend/controllers/notificaciones.controller.md","sourceDirName":"backend/controllers","slug":"/backend/controllers/notificaciones.controller","permalink":"/producttrack/docs/backend/controllers/notificaciones.controller","draft":false,"unlisted":false,"editUrl":"https://github.com/Mari0724/producttrack/docs/backend/controllers/notificaciones.controller.md","tags":[],"version":"current","frontMatter":{"id":"notificaciones.controller","title":"NotificacionesController","sidebar_label":"Notificaciones"},"sidebar":"tutorialSidebar","previous":{"title":"Login","permalink":"/producttrack/docs/backend/controllers/log.controller"},"next":{"title":"NutriScan","permalink":"/producttrack/docs/backend/controllers/nutriscan.controller"}}');var c=i(4848),s=i(8453);const a={id:"notificaciones.controller",title:"NotificacionesController",sidebar_label:"Notificaciones"},r="NotificacionesController",l={},d=[{value:"\ud83d\udd0d Ubicaci\xf3n",id:"-ubicaci\xf3n",level:2},{value:"\ud83d\udccc Endpoints",id:"-endpoints",level:2},{value:"\ud83d\udce4 Enviar notificaciones",id:"-enviar-notificaciones",level:3},{value:"\ud83d\udea8 Stock bajo",id:"-stock-bajo",level:4},{value:"Body (opcional):",id:"body-opcional",level:5},{value:"Respuesta:",id:"respuesta",level:5},{value:"\ud83e\uddea Producto vencido",id:"-producto-vencido",level:4},{value:"Body (opcional):",id:"body-opcional-1",level:5},{value:"Respuesta:",id:"respuesta-1",level:5},{value:"\ud83d\udcac Comentario en producto",id:"-comentario-en-producto",level:4},{value:"Body:",id:"body",level:5},{value:"Respuesta:",id:"respuesta-2",level:5},{value:"\ud83d\udd04 Reposici\xf3n recomendada",id:"-reposici\xf3n-recomendada",level:4},{value:"Body (opcional):",id:"body-opcional-2",level:5},{value:"Respuesta:",id:"respuesta-3",level:5},{value:"\ud83d\udee0\ufe0f Actualizaci\xf3n de la aplicaci\xf3n",id:"\ufe0f-actualizaci\xf3n-de-la-aplicaci\xf3n",level:4},{value:"Body:",id:"body-1",level:5},{value:"Respuesta:",id:"respuesta-4",level:5},{value:"\ud83d\udce5 Obtener notificaciones del usuario",id:"-obtener-notificaciones-del-usuario",level:3},{value:"Par\xe1metros:",id:"par\xe1metros",level:4},{value:"Respuesta:",id:"respuesta-5",level:5},{value:"\u2705 Marcar notificaci\xf3n como le\xedda",id:"-marcar-notificaci\xf3n-como-le\xedda",level:3},{value:"Par\xe1metros:",id:"par\xe1metros-1",level:4},{value:"Respuesta:",id:"respuesta-6",level:5},{value:"\u2699\ufe0f Actualizar preferencias de notificaci\xf3n",id:"\ufe0f-actualizar-preferencias-de-notificaci\xf3n",level:3},{value:"Par\xe1metros:",id:"par\xe1metros-2",level:4},{value:"Body:",id:"body-2",level:4},{value:"Respuesta:",id:"respuesta-7",level:5},{value:"\ud83d\udee0\ufe0f Notas t\xe9cnicas",id:"\ufe0f-notas-t\xe9cnicas",level:2}];function t(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"notificacionescontroller",children:"NotificacionesController"})}),"\n",(0,c.jsx)(n.p,{children:"Este controlador gestiona el env\xedo y configuraci\xf3n de notificaciones para los usuarios. Las notificaciones cubren eventos como bajo stock, vencimiento de productos, comentarios, recomendaciones de reposici\xf3n y actualizaciones de la app."}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h2,{id:"-ubicaci\xf3n",children:"\ud83d\udd0d Ubicaci\xf3n"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.code,{children:"src/controllers/notificaciones.controller.ts"})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h2,{id:"-endpoints",children:"\ud83d\udccc Endpoints"}),"\n",(0,c.jsx)(n.h3,{id:"-enviar-notificaciones",children:"\ud83d\udce4 Enviar notificaciones"}),"\n",(0,c.jsx)(n.h4,{id:"-stock-bajo",children:"\ud83d\udea8 Stock bajo"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"POST"})," ",(0,c.jsx)(n.code,{children:"/notificaciones/stock-bajo"})]}),"\n",(0,c.jsx)(n.p,{children:"Env\xeda notificaciones por productos con bajo stock."}),"\n",(0,c.jsx)(n.h5,{id:"body-opcional",children:"Body (opcional):"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{\r\n  "productos": [{ "id": 1 }, { "id": 2 }]\r\n}\n'})}),"\n",(0,c.jsx)(n.h5,{id:"respuesta",children:"Respuesta:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{ "mensaje": "Notificaciones de stock bajo enviadas correctamente" }\n'})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h4,{id:"-producto-vencido",children:"\ud83e\uddea Producto vencido"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"POST"})," ",(0,c.jsx)(n.code,{children:"/notificaciones/producto-vencido"})]}),"\n",(0,c.jsx)(n.p,{children:"Env\xeda notificaciones por productos vencidos. Si no se especifican productos, se notifican todos los vencidos."}),"\n",(0,c.jsx)(n.h5,{id:"body-opcional-1",children:"Body (opcional):"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{\r\n  "productos": [{ "id": 3 }]\r\n}\n'})}),"\n",(0,c.jsx)(n.h5,{id:"respuesta-1",children:"Respuesta:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{ "mensaje": "Notificaciones de producto vencido enviadas correctamente" }\n'})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h4,{id:"-comentario-en-producto",children:"\ud83d\udcac Comentario en producto"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"POST"})," ",(0,c.jsx)(n.code,{children:"/notificaciones/comentario-producto"})]}),"\n",(0,c.jsx)(n.p,{children:"Env\xeda una notificaci\xf3n cuando alguien comenta un producto."}),"\n",(0,c.jsx)(n.h5,{id:"body",children:"Body:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{ "idComentario": 7 }\n'})}),"\n",(0,c.jsx)(n.h5,{id:"respuesta-2",children:"Respuesta:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{ "mensaje": "Notificaciones de comentario enviadas correctamente" }\n'})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h4,{id:"-reposici\xf3n-recomendada",children:"\ud83d\udd04 Reposici\xf3n recomendada"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"POST"})," ",(0,c.jsx)(n.code,{children:"/notificaciones/reposicion-recomendada"})]}),"\n",(0,c.jsx)(n.p,{children:"Env\xeda notificaciones de productos que se recomienda reponer."}),"\n",(0,c.jsx)(n.h5,{id:"body-opcional-2",children:"Body (opcional):"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{\r\n  "productos": [{ "id": 8 }]\r\n}\n'})}),"\n",(0,c.jsx)(n.h5,{id:"respuesta-3",children:"Respuesta:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{ "mensaje": "Notificaciones de reposici\xf3n recomendada enviadas correctamente" }\n'})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h4,{id:"\ufe0f-actualizaci\xf3n-de-la-aplicaci\xf3n",children:"\ud83d\udee0\ufe0f Actualizaci\xf3n de la aplicaci\xf3n"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"POST"})," ",(0,c.jsx)(n.code,{children:"/notificaciones/actualizacion-app"})]}),"\n",(0,c.jsx)(n.p,{children:"Env\xeda una notificaci\xf3n global sobre actualizaciones en la app."}),"\n",(0,c.jsx)(n.h5,{id:"body-1",children:"Body:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{\r\n  "titulo": "Nueva versi\xf3n disponible",\r\n  "mensaje": "La versi\xf3n 2.0 incluye mejoras importantes."\r\n}\n'})}),"\n",(0,c.jsx)(n.h5,{id:"respuesta-4",children:"Respuesta:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{ "mensaje": "Notificaciones de actualizaci\xf3n de la app enviadas correctamente" }\n'})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h3,{id:"-obtener-notificaciones-del-usuario",children:"\ud83d\udce5 Obtener notificaciones del usuario"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"GET"})," ",(0,c.jsx)(n.code,{children:"/notificaciones/usuario/{idUsuario}"})]}),"\n",(0,c.jsx)(n.p,{children:"Obtiene las \xfaltimas 20 notificaciones del usuario, filtradas por sus preferencias."}),"\n",(0,c.jsx)(n.h4,{id:"par\xe1metros",children:"Par\xe1metros:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"idUsuario"})," (path) \u2013 ID del usuario."]}),"\n"]}),"\n",(0,c.jsx)(n.h5,{id:"respuesta-5",children:"Respuesta:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'[\r\n  {\r\n    "idNotificacion": 1,\r\n    "tipo": "STOCK_BAJO",\r\n    "titulo": "Alerta de stock",\r\n    "mensaje": "El producto X tiene bajo stock",\r\n    "leida": false,\r\n    "fechaEnvio": "2025-08-03T14:23:00Z"\r\n  }\r\n]\n'})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:"\u26a0\ufe0f Si el usuario no tiene preferencias configuradas, se crean por defecto con todos los tipos de notificaci\xf3n habilitados."}),"\n"]}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h3,{id:"-marcar-notificaci\xf3n-como-le\xedda",children:"\u2705 Marcar notificaci\xf3n como le\xedda"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"PATCH"})," ",(0,c.jsx)(n.code,{children:"/notificaciones/{idNotificacion}"})]}),"\n",(0,c.jsx)(n.p,{children:"Marca una notificaci\xf3n espec\xedfica como le\xedda."}),"\n",(0,c.jsx)(n.h4,{id:"par\xe1metros-1",children:"Par\xe1metros:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"idNotificacion"})," (path) \u2013 ID de la notificaci\xf3n."]}),"\n"]}),"\n",(0,c.jsx)(n.h5,{id:"respuesta-6",children:"Respuesta:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{ "mensaje": "Notificaci\xf3n marcada como le\xedda" }\n'})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h3,{id:"\ufe0f-actualizar-preferencias-de-notificaci\xf3n",children:"\u2699\ufe0f Actualizar preferencias de notificaci\xf3n"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"PATCH"})," ",(0,c.jsx)(n.code,{children:"/notificaciones/preferencias/{idUsuario}"})]}),"\n",(0,c.jsx)(n.p,{children:"Permite actualizar las preferencias de notificaci\xf3n del usuario."}),"\n",(0,c.jsx)(n.h4,{id:"par\xe1metros-2",children:"Par\xe1metros:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"idUsuario"})," (path) \u2013 ID del usuario."]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"body-2",children:"Body:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{\r\n  "stockBajo": true,\r\n  "productoVencido": false,\r\n  "comentarios": true,\r\n  "reposicion": true,\r\n  "actualizacion": true\r\n}\n'})}),"\n",(0,c.jsx)(n.h5,{id:"respuesta-7",children:"Respuesta:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{ "mensaje": "Preferencias actualizadas correctamente" }\n'})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h2,{id:"\ufe0f-notas-t\xe9cnicas",children:"\ud83d\udee0\ufe0f Notas t\xe9cnicas"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Las preferencias de notificaci\xf3n se almacenan en la tabla ",(0,c.jsx)(n.code,{children:"preferenciasNotificaciones"}),"."]}),"\n",(0,c.jsx)(n.li,{children:"Las notificaciones se filtran seg\xfan las preferencias activas del usuario antes de ser mostradas."}),"\n",(0,c.jsxs)(n.li,{children:["Las funciones de env\xedo de notificaciones utilizan servicios separados especializados para cada tipo (",(0,c.jsx)(n.code,{children:"stockBajo"}),", ",(0,c.jsx)(n.code,{children:"productoVencido"}),", etc.)."]}),"\n",(0,c.jsx)(n.li,{children:"Si un usuario no tiene configuraciones previas, se crean autom\xe1ticamente con todos los tipos activados."}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(t,{...e})}):t(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>r});var o=i(6540);const c={},s=o.createContext(c);function a(e){const n=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:a(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);