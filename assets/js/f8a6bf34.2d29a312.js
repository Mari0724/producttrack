"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6741],{1296:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"backend/services/token.service","title":"Servicio Token","description":"Este archivo proporciona funciones utilitarias para la generaci\xf3n y verificaci\xf3n de tokens JWT utilizados en el sistema de autenticaci\xf3n de usuarios.","source":"@site/docs/backend/services/token.service.md","sourceDirName":"backend/services","slug":"/backend/services/token.service","permalink":"/producttrack/docs/backend/services/token.service","draft":false,"unlisted":false,"editUrl":"https://github.com/Mari0724/producttrack/docs/backend/services/token.service.md","tags":[],"version":"current","frontMatter":{"id":"token.service","title":"Servicio Token","sidebar_label":"Token Service"},"sidebar":"tutorialSidebar","previous":{"title":"OpenFoodFactsService","permalink":"/producttrack/docs/backend/services/openfoodfacts.service"},"next":{"title":"User Service","permalink":"/producttrack/docs/backend/services/user.service"}}');var o=r(4848),s=r(8453);const a={id:"token.service",title:"Servicio Token",sidebar_label:"Token Service"},c="Token Service",l={},d=[{value:"\ud83d\udd0d Ubicaci\xf3n",id:"-ubicaci\xf3n",level:2},{value:"\ud83d\udce6 Dependencias",id:"-dependencias",level:2},{value:"\ud83d\udd10 Validaci\xf3n del Secreto",id:"-validaci\xf3n-del-secreto",level:2},{value:"\ud83e\udde9 <code>interface TokenPayload</code>",id:"-interface-tokenpayload",level:2},{value:"\ud83d\udd11 <code>generarToken(payload: TokenPayload): string</code>",id:"-generartokenpayload-tokenpayload-string",level:2},{value:"Par\xe1metros:",id:"par\xe1metros",level:3},{value:"Comportamiento:",id:"comportamiento",level:3},{value:"Retorno:",id:"retorno",level:3},{value:"Ejemplo:",id:"ejemplo",level:3},{value:"\u2705 <code>verificarToken(token: string): TokenPayload</code>",id:"-verificartokentoken-string-tokenpayload",level:2},{value:"Par\xe1metros:",id:"par\xe1metros-1",level:3},{value:"Retorno:",id:"retorno-1",level:3},{value:"Lanza:",id:"lanza",level:3},{value:"\ud83e\udde0 Observaciones",id:"-observaciones",level:2}];function t(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"token-service",children:"Token Service"})}),"\n",(0,o.jsxs)(n.p,{children:["Este archivo proporciona funciones utilitarias para la ",(0,o.jsx)(n.strong,{children:"generaci\xf3n"})," y ",(0,o.jsx)(n.strong,{children:"verificaci\xf3n"})," de tokens JWT utilizados en el sistema de autenticaci\xf3n de usuarios."]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"-ubicaci\xf3n",children:"\ud83d\udd0d Ubicaci\xf3n"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"src/services/token.service.ts"})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"-dependencias",children:"\ud83d\udce6 Dependencias"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://www.npmjs.com/package/jsonwebtoken",children:(0,o.jsx)(n.code,{children:"jsonwebtoken"})}),": Para firmar y verificar JWTs."]}),"\n",(0,o.jsxs)(n.li,{children:["Variables de entorno: ",(0,o.jsx)(n.code,{children:"JWT_SECRET"})," debe estar definida en el archivo ",(0,o.jsx)(n.code,{children:".env"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"-validaci\xf3n-del-secreto",children:"\ud83d\udd10 Validaci\xf3n del Secreto"}),"\n",(0,o.jsxs)(n.p,{children:["Antes de ejecutar cualquier funci\xf3n, el archivo verifica que la variable de entorno ",(0,o.jsx)(n.code,{children:"JWT_SECRET"})," exista, lanzando un error si no est\xe1 definida."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'if (!process.env.JWT_SECRET) {\r\n  throw new Error("Falta la variable JWT_SECRET en el archivo .env");\r\n}\n'})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsxs)(n.h2,{id:"-interface-tokenpayload",children:["\ud83e\udde9 ",(0,o.jsx)(n.code,{children:"interface TokenPayload"})]}),"\n",(0,o.jsx)(n.p,{children:"Define el tipo de datos que puede contener un token generado:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"interface TokenPayload {\r\n  id: number;\r\n  username: string;\r\n  rol: string;\r\n  tipoUsuario?: string;\r\n  rolEquipo?: string;\r\n}\n"})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsxs)(n.h2,{id:"-generartokenpayload-tokenpayload-string",children:["\ud83d\udd11 ",(0,o.jsx)(n.code,{children:"generarToken(payload: TokenPayload): string"})]}),"\n",(0,o.jsxs)(n.p,{children:["Genera un JWT firmado con una validez de 1 d\xeda (",(0,o.jsx)(n.code,{children:"1d"}),")."]}),"\n",(0,o.jsx)(n.h3,{id:"par\xe1metros",children:"Par\xe1metros:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"payload"}),": Objeto que incluye el ID, nombre de usuario, rol y, opcionalmente, ",(0,o.jsx)(n.code,{children:"tipoUsuario"})," y ",(0,o.jsx)(n.code,{children:"rolEquipo"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"comportamiento",children:"Comportamiento:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Construye un objeto parcial del payload original."}),"\n",(0,o.jsxs)(n.li,{children:["Solo incluye ",(0,o.jsx)(n.code,{children:"rolEquipo"})," si el rol es ",(0,o.jsx)(n.code,{children:'"EQUIPO"'}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"retorno",children:"Retorno:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Un token JWT firmado."}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"ejemplo",children:"Ejemplo:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'const token = generarToken({\r\n  id: 1,\r\n  username: "empresa123",\r\n  rol: "EQUIPO",\r\n  tipoUsuario: "EMPRESARIAL",\r\n  rolEquipo: "EDITOR"\r\n});\n'})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsxs)(n.h2,{id:"-verificartokentoken-string-tokenpayload",children:["\u2705 ",(0,o.jsx)(n.code,{children:"verificarToken(token: string): TokenPayload"})]}),"\n",(0,o.jsx)(n.p,{children:"Verifica un token JWT y devuelve el contenido decodificado."}),"\n",(0,o.jsx)(n.h3,{id:"par\xe1metros-1",children:"Par\xe1metros:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"token"}),": El JWT a verificar."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"retorno-1",children:"Retorno:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Un objeto ",(0,o.jsx)(n.code,{children:"TokenPayload"})," con los datos originales."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"lanza",children:"Lanza:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Error si el token es inv\xe1lido o ha expirado."}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"-observaciones",children:"\ud83e\udde0 Observaciones"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Este servicio encapsula la l\xf3gica JWT para separar responsabilidades."}),"\n",(0,o.jsx)(n.li,{children:"El control sobre el contenido del token permite personalizar la informaci\xf3n incluida seg\xfan el rol del usuario."}),"\n",(0,o.jsx)(n.li,{children:"Su integraci\xf3n es ideal para middlewares y validaciones de seguridad en rutas protegidas."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(t,{...e})}):t(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>c});var i=r(6540);const o={},s=i.createContext(o);function a(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);