"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9831],{5394:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"frontend/context/user-context","title":"Contexto Global de Usuario","description":"El archivo UserContext.tsx define un contexto global de React que gestiona la informaci\xf3n del usuario autenticado a lo largo de toda la aplicaci\xf3n. Esto incluye su token, rol, tipo de cuenta y estado de carga. Tambi\xe9n proporciona funciones para establecer o refrescar el estado del usuario desde el token JWT almacenado.","source":"@site/docs/frontend/context/UserContext.md","sourceDirName":"frontend/context","slug":"/frontend/context/user-context","permalink":"/producttrack/docs/frontend/context/user-context","draft":false,"unlisted":false,"editUrl":"https://github.com/Mari0724/producttrack/docs/frontend/context/UserContext.md","tags":[],"version":"current","frontMatter":{"id":"user-context","title":"Contexto Global de Usuario","sidebar_label":"UserContext"},"sidebar":"tutorialSidebar","previous":{"title":"SecuritySettings","permalink":"/producttrack/docs/frontend/components/team/security-settings"},"next":{"title":"useToast","permalink":"/producttrack/docs/frontend/hooks/use-toast"}}');var s=o(4848),d=o(8453);const a={id:"user-context",title:"Contexto Global de Usuario",sidebar_label:"UserContext"},i=void 0,c={},l=[{value:"\ud83d\udd0d Ubicaci\xf3n",id:"-ubicaci\xf3n",level:2},{value:"\ud83d\udce6 Dependencias",id:"-dependencias",level:2},{value:"\ud83e\udde9 Estructuras de Datos",id:"-estructuras-de-datos",level:2},{value:"\ud83d\udd10 <code>Usuario</code> (adaptado desde el token)",id:"-usuario-adaptado-desde-el-token",level:3},{value:"\ud83e\uddfe <code>RawToken</code> (estructura cruda decodificada)",id:"-rawtoken-estructura-cruda-decodificada",level:3},{value:"\u2699\ufe0f \xbfQu\xe9 exporta este m\xf3dulo?",id:"\ufe0f-qu\xe9-exporta-este-m\xf3dulo",level:2},{value:"1. <code>UserProvider</code> (componente de contexto)",id:"1-userprovider-componente-de-contexto",level:3},{value:"2. <code>useUser()</code> (hook personalizado)",id:"2-useuser-hook-personalizado",level:3},{value:"\ud83e\udde0 L\xf3gica Interna",id:"-l\xf3gica-interna",level:2},{value:"Estado local",id:"estado-local",level:3},{value:"Efecto inicial",id:"efecto-inicial",level:3},{value:"<code>refreshUsuario()</code>",id:"refreshusuario",level:3},{value:"\ud83e\udded Comportamiento Condicional",id:"-comportamiento-condicional",level:2},{value:"\ud83c\udfa8 Estilos y Dise\xf1o",id:"-estilos-y-dise\xf1o",level:2},{value:"\ud83d\udca1 Ejemplo de Uso",id:"-ejemplo-de-uso",level:2},{value:"Proveedor global",id:"proveedor-global",level:3},{value:"Consumo con <code>useUser()</code>",id:"consumo-con-useuser",level:3},{value:"\ud83d\udccc Notas Adicionales",id:"-notas-adicionales",level:2}];function t(e){const n={code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["El archivo ",(0,s.jsx)(n.code,{children:"UserContext.tsx"})," define un ",(0,s.jsx)(n.strong,{children:"contexto global de React"})," que gestiona la informaci\xf3n del usuario autenticado a lo largo de toda la aplicaci\xf3n. Esto incluye su token, rol, tipo de cuenta y estado de carga. Tambi\xe9n proporciona funciones para establecer o refrescar el estado del usuario desde el token JWT almacenado."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-ubicaci\xf3n",children:"\ud83d\udd0d Ubicaci\xf3n"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"src/context/UserContext.tsx"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-dependencias",children:"\ud83d\udce6 Dependencias"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"React"}),": ",(0,s.jsx)(n.code,{children:"createContext"}),", ",(0,s.jsx)(n.code,{children:"useContext"}),", ",(0,s.jsx)(n.code,{children:"useEffect"}),", ",(0,s.jsx)(n.code,{children:"useState"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"jwt-decode"}),": para decodificar el token JWT del ",(0,s.jsx)(n.code,{children:"localStorage"})]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-estructuras-de-datos",children:"\ud83e\udde9 Estructuras de Datos"}),"\n",(0,s.jsxs)(n.h3,{id:"-usuario-adaptado-desde-el-token",children:["\ud83d\udd10 ",(0,s.jsx)(n.code,{children:"Usuario"})," (adaptado desde el token)"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'interface Usuario {\r\n  idUsuario: number;\r\n  username: string;\r\n  correo: string;\r\n  tipoUsuario: "INDIVIDUAL" | "EMPRESARIAL";\r\n  rol: "ADMIN" | "DESARROLLADOR" | "LECTOR" | "EDITOR" | string;\r\n  rolEquipo?: string;\r\n  empresaId?: number;\r\n  perfilCompleto: boolean;\r\n  nombreEmpresa?: string;\r\n}\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"-rawtoken-estructura-cruda-decodificada",children:["\ud83e\uddfe ",(0,s.jsx)(n.code,{children:"RawToken"})," (estructura cruda decodificada)"]}),"\n",(0,s.jsx)(n.p,{children:"Contiene campos opcionales que son normalizados por el adaptador antes de usarlos."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-qu\xe9-exporta-este-m\xf3dulo",children:"\u2699\ufe0f \xbfQu\xe9 exporta este m\xf3dulo?"}),"\n",(0,s.jsxs)(n.h3,{id:"1-userprovider-componente-de-contexto",children:["1. ",(0,s.jsx)(n.code,{children:"UserProvider"})," (componente de contexto)"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"<UserProvider>\r\n  {/* children de la app */}\r\n</UserProvider>\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Proveedor que encapsula la l\xf3gica de lectura y adaptaci\xf3n del token del ",(0,s.jsx)(n.code,{children:"localStorage"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Establece el estado global ",(0,s.jsx)(n.code,{children:"usuario"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Gestiona el estado ",(0,s.jsx)(n.code,{children:"cargando"})," para indicar si la verificaci\xf3n inicial ha terminado."]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"2-useuser-hook-personalizado",children:["2. ",(0,s.jsx)(n.code,{children:"useUser()"})," (hook personalizado)"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"const { usuario, setUsuario, cargando, refreshUsuario } = useUser();\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Permite acceder al contexto del usuario desde cualquier componente hijo del ",(0,s.jsx)(n.code,{children:"UserProvider"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-l\xf3gica-interna",children:"\ud83e\udde0 L\xf3gica Interna"}),"\n",(0,s.jsx)(n.h3,{id:"estado-local",children:"Estado local"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"usuario: Usuario | null;\r\ncargando: boolean;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"efecto-inicial",children:"Efecto inicial"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Se ejecuta en ",(0,s.jsx)(n.code,{children:"useEffect"})," al montar el componente."]}),"\n",(0,s.jsxs)(n.li,{children:["Si hay token en ",(0,s.jsx)(n.code,{children:"localStorage"}),", se decodifica y se adapta al tipo ",(0,s.jsx)(n.code,{children:"Usuario"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Se setea el estado ",(0,s.jsx)(n.code,{children:"usuario"})," con la informaci\xf3n extra\xedda del token."]}),"\n",(0,s.jsxs)(n.li,{children:["Finaliza estableciendo ",(0,s.jsx)(n.code,{children:"cargando: false"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"refreshusuario",children:(0,s.jsx)(n.code,{children:"refreshUsuario()"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"M\xe9todo expuesto por el contexto para volver a leer el token JWT manualmente (sin recargar la p\xe1gina)."}),"\n",(0,s.jsx)(n.li,{children:"\xdatil despu\xe9s de un login, edici\xf3n de perfil, etc."}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-comportamiento-condicional",children:"\ud83e\udded Comportamiento Condicional"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Condici\xf3n"}),(0,s.jsx)(n.th,{children:"Resultado"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsxs)(n.td,{children:["Token v\xe1lido en ",(0,s.jsx)(n.code,{children:"localStorage"})]}),(0,s.jsxs)(n.td,{children:["Se decodifica y adapta al formato interno ",(0,s.jsx)(n.code,{children:"Usuario"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Token inv\xe1lido o ausente"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"usuario"})," permanece como ",(0,s.jsx)(n.code,{children:"null"}),", y se marca como no cargando"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Error de decodificaci\xf3n"}),(0,s.jsx)(n.td,{children:"Se registra en consola con prefijo \u274c y no se actualiza el estado"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-estilos-y-dise\xf1o",children:"\ud83c\udfa8 Estilos y Dise\xf1o"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Este archivo no incluye estilos, ya que es puramente ",(0,s.jsx)(n.strong,{children:"l\xf3gica y estado compartido"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-ejemplo-de-uso",children:"\ud83d\udca1 Ejemplo de Uso"}),"\n",(0,s.jsx)(n.h3,{id:"proveedor-global",children:"Proveedor global"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'import { UserProvider } from "./context/UserContext";\r\n\r\nfunction App() {\r\n  return (\r\n    <UserProvider>\r\n      <YourRoutesOrLayout />\r\n    </UserProvider>\r\n  );\r\n}\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"consumo-con-useuser",children:["Consumo con ",(0,s.jsx)(n.code,{children:"useUser()"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'import { useUser } from "../context/UserContext";\r\n\r\nconst Perfil = () => {\r\n  const { usuario, cargando } = useUser();\r\n\r\n  if (cargando) return <p>Cargando...</p>;\r\n\r\n  return (\r\n    <div>\r\n      <h1>Hola, {usuario?.username}</h1>\r\n    </div>\r\n  );\r\n};\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-notas-adicionales",children:"\ud83d\udccc Notas Adicionales"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u26a0\ufe0f El hook ",(0,s.jsx)(n.code,{children:"useUser()"})," ",(0,s.jsx)(n.strong,{children:"lanza un error"})," si se usa fuera de un ",(0,s.jsx)(n.code,{children:"UserProvider"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Las claves ",(0,s.jsx)(n.code,{children:"rolEquipo"}),", ",(0,s.jsx)(n.code,{children:"nombreEmpresa"}),", etc. son opcionales para soportar diferentes tipos de usuarios (individuales o empresariales)."]}),"\n",(0,s.jsx)(n.li,{children:"Est\xe1 preparado para escalar a futuros roles o campos nuevos sin romper la estructura."}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>a,x:()=>i});var r=o(6540);const s={},d=r.createContext(s);function a(e){const n=r.useContext(d);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(d.Provider,{value:n},e.children)}}}]);