"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6338],{6662:(e,i,r)=>{r.r(i),r.d(i,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"backend/services/equipo.service","title":"Servicio Equipo","description":"Este servicio administra a los usuarios del tipo EQUIPO dentro de una empresa.","source":"@site/docs/backend/services/equipo.service.md","sourceDirName":"backend/services","slug":"/backend/services/equipo.service","permalink":"/producttrack/docs/backend/services/equipo.service","draft":false,"unlisted":false,"editUrl":"https://github.com/Mari0724/producttrack/docs/backend/services/equipo.service.md","tags":[],"version":"current","frontMatter":{"id":"equipo.service","title":"Servicio Equipo","sidebar_label":"Equipo"},"sidebar":"tutorialSidebar","previous":{"title":"Email","permalink":"/producttrack/docs/backend/services/email-service"},"next":{"title":"GPT","permalink":"/producttrack/docs/backend/services/gpt.service"}}');var s=r(4848),a=r(8453);const o={id:"equipo.service",title:"Servicio Equipo",sidebar_label:"Equipo"},l=void 0,d={},c=[{value:"\ud83d\udd0d Ubicaci\xf3n",id:"-ubicaci\xf3n",level:2},{value:"\ud83d\udce6 Dependencias",id:"-dependencias",level:2},{value:"\ud83e\udde9 Clase: <code>EquipoService</code>",id:"-clase-equiposervice",level:2},{value:"\ud83d\udee0\ufe0f <code>async crearEquipo(data: EquipoDTO, empresaId: number)</code>",id:"\ufe0f-async-crearequipodata-equipodto-empresaid-number",level:3},{value:"Par\xe1metros:",id:"par\xe1metros",level:4},{value:"Retorna:",id:"retorna",level:4},{value:"Lanza:",id:"lanza",level:4},{value:"Observaciones:",id:"observaciones",level:4},{value:"\ud83d\udcc4 <code>async obtenerTodosLosEquipos(empresaId?: number)</code>",id:"-async-obtenertodoslosequiposempresaid-number",level:3},{value:"Par\xe1metros:",id:"par\xe1metros-1",level:4},{value:"Retorna:",id:"retorna-1",level:4},{value:"\ud83d\udd0d <code>async filtrarEquipos(filtros: {...})</code>",id:"-async-filtrarequiposfiltros-",level:3},{value:"Par\xe1metros:",id:"par\xe1metros-2",level:4},{value:"Retorna:",id:"retorna-2",level:4},{value:"Observaciones:",id:"observaciones-1",level:4},{value:"\ud83d\udd0e <code>async obtenerEquipoPorId(id: number)</code>",id:"-async-obtenerequipoporidid-number",level:3},{value:"Par\xe1metros:",id:"par\xe1metros-3",level:4},{value:"Retorna:",id:"retorna-3",level:4},{value:"Lanza:",id:"lanza-1",level:4},{value:"\u270f\ufe0f <code>async actualizarEquipo(id: number, datosActualizados: Partial&lt;EquipoDTO&gt;, empresaId?: number)</code>",id:"\ufe0f-async-actualizarequipoid-number-datosactualizados-partialequipodto-empresaid-number",level:3},{value:"Par\xe1metros:",id:"par\xe1metros-4",level:4},{value:"Retorna:",id:"retorna-4",level:4},{value:"Lanza:",id:"lanza-2",level:4},{value:"Observaciones:",id:"observaciones-2",level:4},{value:"\ud83d\uddd1\ufe0f <code>async eliminarLogico(id: number, empresaId?: number)</code>",id:"\ufe0f-async-eliminarlogicoid-number-empresaid-number",level:3},{value:"Par\xe1metros:",id:"par\xe1metros-5",level:4},{value:"Retorna:",id:"retorna-5",level:4},{value:"Lanza:",id:"lanza-3",level:4},{value:"\ud83e\udde8 <code>async eliminarTodoElEquipo(empresaId: number)</code>",id:"-async-eliminartodoelequipoempresaid-number",level:3},{value:"Par\xe1metros:",id:"par\xe1metros-6",level:4},{value:"Retorna:",id:"retorna-6",level:4},{value:"\u2705 Validaci\xf3n",id:"-validaci\xf3n",level:2},{value:"\ud83e\uddea Ejemplo de uso",id:"-ejemplo-de-uso",level:2}];function t(e){const i={br:"br",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i.p,{children:["Este servicio administra a los ",(0,s.jsx)(i.strong,{children:"usuarios del tipo EQUIPO"})," dentro de una empresa.",(0,s.jsx)(i.br,{}),"\n","Permite crear, consultar, filtrar, actualizar y realizar eliminaci\xf3n l\xf3gica de registros del rol ",(0,s.jsx)(i.code,{children:"EQUIPO"}),"."]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-ubicaci\xf3n",children:"\ud83d\udd0d Ubicaci\xf3n"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.code,{children:"src/services/equipo.service.ts"})}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-dependencias",children:"\ud83d\udce6 Dependencias"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"prisma"}),": Cliente ORM para interactuar con la base de datos."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"EquipoDTO"}),": Tipo de datos para validaci\xf3n de entradas."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"equipoSchema"}),": Esquema Zod que valida los datos de entrada."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"sendTeamWelcomeEmail"}),": Servicio de correo para enviar credenciales al equipo."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"bcrypt"}),": Para el cifrado de contrase\xf1as."]}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsxs)(i.h2,{id:"-clase-equiposervice",children:["\ud83e\udde9 Clase: ",(0,s.jsx)(i.code,{children:"EquipoService"})]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsxs)(i.h3,{id:"\ufe0f-async-crearequipodata-equipodto-empresaid-number",children:["\ud83d\udee0\ufe0f ",(0,s.jsx)(i.code,{children:"async crearEquipo(data: EquipoDTO, empresaId: number)"})]}),"\n",(0,s.jsxs)(i.p,{children:["Crea un nuevo usuario con rol ",(0,s.jsx)(i.code,{children:"EQUIPO"})," dentro de una empresa espec\xedfica y env\xeda un correo de bienvenida con sus credenciales."]}),"\n",(0,s.jsx)(i.h4,{id:"par\xe1metros",children:"Par\xe1metros:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"data"}),": Objeto con los datos del nuevo equipo (validado por ",(0,s.jsx)(i.code,{children:"equipoSchema"}),")."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"empresaId"}),": ID de la empresa a la que pertenece."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"retorna",children:"Retorna:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Objeto del equipo reci\xe9n creado."}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"lanza",children:"Lanza:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Error si los datos no cumplen el esquema de validaci\xf3n."}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"observaciones",children:"Observaciones:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["La contrase\xf1a se almacena en formato ",(0,s.jsx)(i.strong,{children:"hash"})," usando ",(0,s.jsx)(i.code,{children:"bcrypt"}),"."]}),"\n",(0,s.jsx)(i.li,{children:"El correo de bienvenida incluye la contrase\xf1a original y el nombre de la empresa."}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsxs)(i.h3,{id:"-async-obtenertodoslosequiposempresaid-number",children:["\ud83d\udcc4 ",(0,s.jsx)(i.code,{children:"async obtenerTodosLosEquipos(empresaId?: number)"})]}),"\n",(0,s.jsxs)(i.p,{children:["Obtiene todos los usuarios con rol ",(0,s.jsx)(i.code,{children:"EQUIPO"})," y estado activo, ignorando los eliminados l\xf3gicamente."]}),"\n",(0,s.jsx)(i.h4,{id:"par\xe1metros-1",children:"Par\xe1metros:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"empresaId"}),": ",(0,s.jsx)(i.em,{children:"(Opcional)"})," Si se especifica, se filtra solo por los equipos de esa empresa."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"retorna-1",children:"Retorna:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Lista de usuarios activos con el rol ",(0,s.jsx)(i.code,{children:"EQUIPO"})," que no tienen ",(0,s.jsx)(i.code,{children:"deletedAt"})," registrado."]}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsxs)(i.h3,{id:"-async-filtrarequiposfiltros-",children:["\ud83d\udd0d ",(0,s.jsx)(i.code,{children:"async filtrarEquipos(filtros: {...})"})]}),"\n",(0,s.jsxs)(i.p,{children:["Permite aplicar m\xfaltiples filtros para buscar usuarios ",(0,s.jsx)(i.code,{children:"EQUIPO"}),"."]}),"\n",(0,s.jsx)(i.h4,{id:"par\xe1metros-2",children:"Par\xe1metros:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-ts",children:'{\r\n  nombreCompleto?: string;\r\n  correo?: string;\r\n  rolEquipo?: "LECTOR" | "COMENTARISTA" | "EDITOR";\r\n  estado?: "activo" | "inactivo";\r\n  perfilCompleto?: boolean;\r\n  empresaId?: number;\r\n}\n'})}),"\n",(0,s.jsx)(i.h4,{id:"retorna-2",children:"Retorna:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Lista de equipos que cumplen con los criterios dados."}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"observaciones-1",children:"Observaciones:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["La b\xfasqueda por ",(0,s.jsx)(i.code,{children:"nombreCompleto"})," y ",(0,s.jsx)(i.code,{children:"correo"})," es ",(0,s.jsx)(i.strong,{children:"insensible a may\xfasculas/min\xfasculas"}),"."]}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsxs)(i.h3,{id:"-async-obtenerequipoporidid-number",children:["\ud83d\udd0e ",(0,s.jsx)(i.code,{children:"async obtenerEquipoPorId(id: number)"})]}),"\n",(0,s.jsxs)(i.p,{children:["Busca un usuario ",(0,s.jsx)(i.code,{children:"EQUIPO"})," por su ",(0,s.jsx)(i.code,{children:"idUsuario"}),"."]}),"\n",(0,s.jsx)(i.h4,{id:"par\xe1metros-3",children:"Par\xe1metros:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"id"}),": Identificador \xfanico del usuario."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"retorna-3",children:"Retorna:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Objeto del equipo correspondiente."}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"lanza-1",children:"Lanza:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Error si el usuario no existe o no tiene rol ",(0,s.jsx)(i.code,{children:"EQUIPO"}),"."]}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsxs)(i.h3,{id:"\ufe0f-async-actualizarequipoid-number-datosactualizados-partialequipodto-empresaid-number",children:["\u270f\ufe0f ",(0,s.jsx)(i.code,{children:"async actualizarEquipo(id: number, datosActualizados: Partial<EquipoDTO>, empresaId?: number)"})]}),"\n",(0,s.jsxs)(i.p,{children:["Actualiza los datos de un usuario ",(0,s.jsx)(i.code,{children:"EQUIPO"}),"."]}),"\n",(0,s.jsx)(i.h4,{id:"par\xe1metros-4",children:"Par\xe1metros:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"id"}),": ID del equipo a actualizar."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"datosActualizados"}),": Objeto con los campos que se desean modificar."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"empresaId"}),": ",(0,s.jsx)(i.em,{children:"(Opcional)"})," ID de la empresa que posee al equipo.\r\nSi se incluye, se valida la pertenencia."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"retorna-4",children:"Retorna:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Objeto actualizado del equipo."}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"lanza-2",children:"Lanza:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Error si el equipo no existe o no pertenece a la empresa especificada (si se proporciona)."}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"observaciones-2",children:"Observaciones:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Se usa ",(0,s.jsx)(i.code,{children:".partial()"})," en ",(0,s.jsx)(i.code,{children:"equipoSchema"})," para permitir actualizaciones parciales."]}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsxs)(i.h3,{id:"\ufe0f-async-eliminarlogicoid-number-empresaid-number",children:["\ud83d\uddd1\ufe0f ",(0,s.jsx)(i.code,{children:"async eliminarLogico(id: number, empresaId?: number)"})]}),"\n",(0,s.jsxs)(i.p,{children:["Realiza una ",(0,s.jsx)(i.strong,{children:"eliminaci\xf3n l\xf3gica"})," de un usuario ",(0,s.jsx)(i.code,{children:"EQUIPO"}),".\r\nSe marca como ",(0,s.jsx)(i.code,{children:"inactivo"})," y se registra la fecha en ",(0,s.jsx)(i.code,{children:"deletedAt"}),"."]}),"\n",(0,s.jsx)(i.h4,{id:"par\xe1metros-5",children:"Par\xe1metros:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"id"}),": Identificador del equipo a eliminar."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"empresaId"}),": ",(0,s.jsx)(i.em,{children:"(Opcional)"})," ID de la empresa. Si se incluye, valida pertenencia."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"retorna-5",children:"Retorna:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Objeto del equipo con su estado actualizado."}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"lanza-3",children:"Lanza:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Error si el usuario no existe, no tiene el rol correcto o no pertenece a la empresa."}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsxs)(i.h3,{id:"-async-eliminartodoelequipoempresaid-number",children:["\ud83e\udde8 ",(0,s.jsx)(i.code,{children:"async eliminarTodoElEquipo(empresaId: number)"})]}),"\n",(0,s.jsxs)(i.p,{children:["Realiza una ",(0,s.jsx)(i.strong,{children:"eliminaci\xf3n l\xf3gica masiva"})," de todos los usuarios del equipo de una empresa espec\xedfica."]}),"\n",(0,s.jsx)(i.h4,{id:"par\xe1metros-6",children:"Par\xe1metros:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"empresaId"}),": ID de la empresa cuyos equipos ser\xe1n marcados como inactivos."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"retorna-6",children:"Retorna:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Objeto con un mensaje que indica cu\xe1ntos equipos fueron marcados como inactivos."}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-validaci\xf3n",children:"\u2705 Validaci\xf3n"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Todos los datos se validan usando el esquema ",(0,s.jsx)(i.code,{children:"equipoSchema"}),"."]}),"\n",(0,s.jsxs)(i.li,{children:["Las actualizaciones permiten campos parciales (",(0,s.jsx)(i.code,{children:"partial()"}),")."]}),"\n",(0,s.jsxs)(i.li,{children:["En todas las operaciones cr\xedticas se valida que el rol sea ",(0,s.jsx)(i.code,{children:'"EQUIPO"'})," y, si aplica, la pertenencia a la empresa."]}),"\n",(0,s.jsxs)(i.li,{children:["La eliminaci\xf3n es ",(0,s.jsx)(i.strong,{children:"l\xf3gica"}),", preservando los registros en la base de datos."]}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-ejemplo-de-uso",children:"\ud83e\uddea Ejemplo de uso"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-ts",children:'const servicio = new EquipoService();\r\n\r\n// Crear nuevo equipo\r\nawait servicio.crearEquipo({\r\n  nombreCompleto: "Juan P\xe9rez",\r\n  correo: "juan@empresa.com",\r\n  password: "segura123",\r\n  username: "jperez",\r\n  telefono: "3214567890",\r\n  direccion: "Calle 123",\r\n  rolEquipo: "EDITOR"\r\n}, 1);\r\n\r\n// Filtrar por empresa y rol\r\nconst resultado = await servicio.filtrarEquipos({\r\n  empresaId: 1,\r\n  rolEquipo: "LECTOR"\r\n});\r\n\r\n// Eliminar equipo individual (l\xf3gico)\r\nawait servicio.eliminarLogico(10, 1);\r\n\r\n// Eliminar l\xf3gicamente a todos los equipos de una empresa\r\nawait servicio.eliminarTodoElEquipo(1);\n'})}),"\n",(0,s.jsx)(i.hr,{})]})}function u(e={}){const{wrapper:i}={...(0,a.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}},8453:(e,i,r)=>{r.d(i,{R:()=>o,x:()=>l});var n=r(6540);const s={},a=n.createContext(s);function o(e){const i=n.useContext(a);return n.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(a.Provider,{value:i},e.children)}}}]);