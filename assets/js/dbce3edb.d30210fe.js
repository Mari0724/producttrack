"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8415],{7876:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>s,contentTitle:()=>c,default:()=>u,frontMatter:()=>d,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"backend/config/cloudinary","title":"Configuraci\xf3n Cloudinary","description":"Este m\xf3dulo configura e integra el servicio de almacenamiento de im\xe1genes Cloudinary con el backend. Incluye una funci\xf3n personalizada para subir im\xe1genes directamente y un almacenamiento compatible con multer para facilitar la carga desde formularios.","source":"@site/docs/backend/config/cloudinary.md","sourceDirName":"backend/config","slug":"/backend/config/cloudinary","permalink":"/producttrack/docs/backend/config/cloudinary","draft":false,"unlisted":false,"editUrl":"https://github.com/Mari0724/producttrack/docs/backend/config/cloudinary.md","tags":[],"version":"current","frontMatter":{"id":"cloudinary","title":"Configuraci\xf3n Cloudinary","sidebar_label":"cloudinary"},"sidebar":"tutorialSidebar","previous":{"title":"app","permalink":"/producttrack/docs/backend/app"},"next":{"title":"Token","permalink":"/producttrack/docs/backend/config/token"}}');var i=r(4848),l=r(8453);const d={id:"cloudinary",title:"Configuraci\xf3n Cloudinary",sidebar_label:"cloudinary"},c=void 0,s={},o=[{value:"\ud83d\udd0d Ubicaci\xf3n",id:"-ubicaci\xf3n",level:2},{value:"\ud83d\udce6 Dependencias utilizadas",id:"-dependencias-utilizadas",level:2},{value:"\ud83d\udd27 Configuraci\xf3n de Cloudinary",id:"-configuraci\xf3n-de-cloudinary",level:2},{value:"\ud83d\udce4 Funci\xf3n: subirImagenCloudinary",id:"-funci\xf3n-subirimagencloudinary",level:2},{value:"\ud83d\uddc2\ufe0f Almacenamiento Cloudinary para multer",id:"\ufe0f-almacenamiento-cloudinary-para-multer",level:2},{value:"\ud83d\ude80 Exportaciones",id:"-exportaciones",level:2},{value:"\u2705 Ejemplo de uso",id:"-ejemplo-de-uso",level:2}];function t(e){const n={blockquote:"blockquote",code:"code",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Este m\xf3dulo configura e integra el servicio de almacenamiento de im\xe1genes Cloudinary con el backend. Incluye una funci\xf3n personalizada para subir im\xe1genes directamente y un almacenamiento compatible con multer para facilitar la carga desde formularios."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-ubicaci\xf3n",children:"\ud83d\udd0d Ubicaci\xf3n"}),"\n",(0,i.jsx)(n.p,{children:"src/config/cloudinary.ts"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-dependencias-utilizadas",children:"\ud83d\udce6 Dependencias utilizadas"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"import { v2 as cloudinary } from 'cloudinary';\r\nimport { CloudinaryStorage } from 'multer-storage-cloudinary';\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"cloudinary: SDK oficial para interactuar con el servicio Cloudinary."}),"\n",(0,i.jsx)(n.li,{children:"multer-storage-cloudinary: Adaptador para usar Cloudinary como almacenamiento con multer."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-configuraci\xf3n-de-cloudinary",children:"\ud83d\udd27 Configuraci\xf3n de Cloudinary"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"cloudinary.config({\r\n  cloud_name: process.env.CLOUDINARY_CLOUD_NAME!,\r\n  api_key: process.env.CLOUDINARY_API_KEY!,\r\n  api_secret: process.env.CLOUDINARY_API_SECRET!,\r\n});\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Variable de entorno"}),(0,i.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"CLOUDINARY_CLOUD_NAME"}),(0,i.jsx)(n.td,{children:"Nombre del Cloud en tu cuenta Cloudinary."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"CLOUDINARY_API_KEY"}),(0,i.jsx)(n.td,{children:"Clave p\xfablica de la API de Cloudinary."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"CLOUDINARY_API_SECRET"}),(0,i.jsx)(n.td,{children:"Clave privada de la API de Cloudinary."})]})]})]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"El operador ! en TypeScript indica que se espera que la variable est\xe9 definida."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-funci\xf3n-subirimagencloudinary",children:"\ud83d\udce4 Funci\xf3n: subirImagenCloudinary"}),"\n",(0,i.jsx)(n.p,{children:"Sube una imagen a Cloudinary manualmente desde una ruta de archivo local."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"export const subirImagenCloudinary = async (filePath: string) => {\r\n  const result = await cloudinary.uploader.upload(filePath, {\r\n    folder: 'productos',\r\n  });\r\n  return result.secure_url;\r\n};\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Par\xe1metro"}),(0,i.jsx)(n.th,{children:"Tipo"}),(0,i.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"filePath"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Ruta local del archivo a subir."})]})})]}),"\n",(0,i.jsxs)(n.p,{children:["\ud83d\udd01 Retorna: una ",(0,i.jsx)(n.code,{children:"Promise<string>"})," con la URL segura (https) de la imagen subida."]}),"\n",(0,i.jsx)(n.p,{children:"\u26a0\ufe0f Si ocurre un error, se lanza una excepci\xf3n y se imprime en consola."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\ufe0f-almacenamiento-cloudinary-para-multer",children:"\ud83d\uddc2\ufe0f Almacenamiento Cloudinary para multer"}),"\n",(0,i.jsx)(n.p,{children:"Este storage se usa para manejar cargas directas desde formularios usando multer."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const storage = new CloudinaryStorage({\r\n  cloudinary,\r\n  params: async (req, file) => {\r\n    return {\r\n      folder: 'productos',\r\n      format: 'jpg',\r\n      public_id: `${Date.now()}-${file.originalname}`,\r\n    };\r\n  },\r\n});\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Campo"}),(0,i.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"folder"}),(0,i.jsx)(n.td,{children:"Carpeta de destino en Cloudinary."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"format"}),(0,i.jsxs)(n.td,{children:["Formato forzado de la imagen (",(0,i.jsx)(n.code,{children:"jpg"}),")."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"public_id"}),(0,i.jsx)(n.td,{children:"Nombre p\xfablico generado autom\xe1ticamente basado en timestamp y filename."})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"Este storage se puede usar en el middleware multer como:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"import multer from 'multer';\r\nimport { storage } from './config/cloudinary';\r\n\r\nconst upload = multer({ storage });\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-exportaciones",children:"\ud83d\ude80 Exportaciones"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"export { cloudinary, storage };\n"})}),"\n",(0,i.jsx)(n.p,{children:"Exporta:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"cloudinary: la instancia configurada de Cloudinary."}),"\n",(0,i.jsx)(n.li,{children:"storage: el almacenamiento personalizado para multer."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-ejemplo-de-uso",children:"\u2705 Ejemplo de uso"}),"\n",(0,i.jsx)(n.p,{children:"Subida manual:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const url = await subirImagenCloudinary("uploads/tmp/imagen.jpg");\n'})}),"\n",(0,i.jsx)(n.p,{children:"Multer middleware:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'router.post("/cargar", upload.single("imagen"), (req, res) => {\r\n  res.json({ url: req.file.path });\r\n});\n'})}),"\n",(0,i.jsx)(n.hr,{})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>d,x:()=>c});var a=r(6540);const i={},l=a.createContext(i);function d(e){const n=a.useContext(l);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),a.createElement(l.Provider,{value:n},e.children)}}}]);