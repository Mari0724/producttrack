"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5450],{4213:(e,r,a)=>{a.r(r),a.d(r,{assets:()=>c,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"backend/middleware/uploadMemory","title":"Middleware de Carga en Memoria","description":"Este middleware configura multer para procesar archivos cargados en la memoria del servidor. Es \xfatil cuando se necesita manipular los archivos directamente (por ejemplo, redimensionar im\xe1genes o realizar OCR) sin almacenarlos en disco.","source":"@site/docs/backend/middleware/uploadMemory.md","sourceDirName":"backend/middleware","slug":"/backend/middleware/uploadMemory","permalink":"/producttrack/docs/backend/middleware/uploadMemory","draft":false,"unlisted":false,"editUrl":"https://github.com/Mari0724/producttrack/docs/backend/middleware/uploadMemory.md","tags":[],"version":"current","frontMatter":{"id":"uploadMemory","title":"Middleware de Carga en Memoria","sidebar_label":"uploadMemory"},"sidebar":"tutorialSidebar","previous":{"title":"Token","permalink":"/producttrack/docs/backend/middleware/token.middleware"},"next":{"title":"Comentario","permalink":"/producttrack/docs/backend/models/comentario"}}');var i=a(4848),o=a(8453);const s={id:"uploadMemory",title:"Middleware de Carga en Memoria",sidebar_label:"uploadMemory"},l=void 0,c={},d=[{value:"\ud83d\udd0d  Ubicaci\xf3n",id:"--ubicaci\xf3n",level:2},{value:"\u2728 Descripci\xf3n",id:"-descripci\xf3n",level:2},{value:"\ud83d\udd27 Implementaci\xf3n",id:"-implementaci\xf3n",level:2},{value:"\ud83d\udccc Uso t\xedpico en rutas",id:"-uso-t\xedpico-en-rutas",level:2},{value:"\u26a0\ufe0f Consideraciones",id:"\ufe0f-consideraciones",level:2},{value:"\ud83e\uddea Acceso al archivo cargado",id:"-acceso-al-archivo-cargado",level:2},{value:"\u2705 Beneficios",id:"-beneficios",level:2}];function t(e){const r={code:"code",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.p,{children:["Este middleware configura ",(0,i.jsx)(r.code,{children:"multer"})," para procesar archivos cargados en la memoria del servidor. Es \xfatil cuando se necesita manipular los archivos directamente (por ejemplo, redimensionar im\xe1genes o realizar OCR) sin almacenarlos en disco."]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"--ubicaci\xf3n",children:"\ud83d\udd0d  Ubicaci\xf3n"}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"src/middleware/uploadMemory.ts"})}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"-descripci\xf3n",children:"\u2728 Descripci\xf3n"}),"\n",(0,i.jsxs)(r.p,{children:["El middleware ",(0,i.jsx)(r.code,{children:"uploadMemory"})," utiliza ",(0,i.jsx)(r.code,{children:"multer.memoryStorage()"})," para guardar archivos en un buffer de memoria temporal en lugar de guardarlos en el sistema de archivos local. Esto es ideal para cargas peque\xf1as que requieren procesamiento inmediato, como:"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"OCR"}),"\n",(0,i.jsx)(r.li,{children:"Validaci\xf3n de im\xe1genes"}),"\n",(0,i.jsx)(r.li,{children:"Subida directa a servicios en la nube (Cloudinary, S3, etc.)"}),"\n"]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"-implementaci\xf3n",children:"\ud83d\udd27 Implementaci\xf3n"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-ts",children:"import multer from 'multer';\r\n\r\nexport const uploadMemory = multer({ storage: multer.memoryStorage() });\n"})}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"-uso-t\xedpico-en-rutas",children:"\ud83d\udccc Uso t\xedpico en rutas"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-ts",children:"import { uploadMemory } from '../middleware/uploadMemory';\r\n\r\nrouter.post('/ocr', uploadMemory.single('file'), extraerTextoDesdeImagen);\n"})}),"\n",(0,i.jsx)(r.p,{children:"En este ejemplo:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"uploadMemory.single('file')"}),": procesa un solo archivo del campo ",(0,i.jsx)(r.code,{children:"file"})," en el formulario."]}),"\n",(0,i.jsxs)(r.li,{children:["El archivo cargado estar\xe1 disponible como ",(0,i.jsx)(r.code,{children:"req.file.buffer"})," para procesamiento posterior."]}),"\n"]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"\ufe0f-consideraciones",children:"\u26a0\ufe0f Consideraciones"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"No recomendable para archivos grandes"}),", ya que la memoria del servidor puede agotarse."]}),"\n",(0,i.jsx)(r.li,{children:"Aseg\xfarate de validar el tipo y tama\xf1o del archivo antes de continuar con el procesamiento."}),"\n"]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"-acceso-al-archivo-cargado",children:"\ud83e\uddea Acceso al archivo cargado"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-ts",children:"const buffer = req.file?.buffer;\r\nconst mimeType = req.file?.mimetype;\r\nconst originalName = req.file?.originalname;\n"})}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"-beneficios",children:"\u2705 Beneficios"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"R\xe1pido para procesamiento en tiempo real."}),"\n",(0,i.jsx)(r.li,{children:"No ensucia el sistema de archivos temporal."}),"\n",(0,i.jsx)(r.li,{children:"Ideal para integraciones con APIs de terceros que aceptan buffers."}),"\n"]})]})}function m(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},8453:(e,r,a)=>{a.d(r,{R:()=>s,x:()=>l});var n=a(6540);const i={},o=n.createContext(i);function s(e){const r=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),n.createElement(o.Provider,{value:r},e.children)}}}]);