"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3379],{946:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"backend/controllers/log.controller","title":"Controlador de Autenticaci\xf3n","description":"Este controlador gestiona el proceso de inicio de sesi\xf3n y restablecimiento de contrase\xf1a para los usuarios registrados. Forma parte del m\xf3dulo de autenticaci\xf3n de la aplicaci\xf3n y expone tres endpoints principales:","source":"@site/docs/backend/controllers/log.controller.md","sourceDirName":"backend/controllers","slug":"/backend/controllers/log.controller","permalink":"/producttrack/docs/backend/controllers/log.controller","draft":false,"unlisted":false,"editUrl":"https://github.com/Mari0724/producttrack/docs/backend/controllers/log.controller.md","tags":[],"version":"current","frontMatter":{"id":"log.controller","title":"Controlador de Autenticaci\xf3n","sidebar_label":"LoginController"},"sidebar":"tutorialSidebar","previous":{"title":"HistorialController","permalink":"/producttrack/docs/backend/controllers/historial.controller"},"next":{"title":"NotificacionesController","permalink":"/producttrack/docs/backend/controllers/notificaciones.controller"}}');var o=n(4848),i=n(8453);const t={id:"log.controller",title:"Controlador de Autenticaci\xf3n",sidebar_label:"LoginController"},c="Controlador de Autenticaci\xf3n",d={},l=[{value:"\ud83d\udd0d Ubicaci\xf3n",id:"-ubicaci\xf3n",level:2},{value:"\ud83d\udccc Endpoint: <code>POST /auth/login</code>",id:"-endpoint-post-authlogin",level:2},{value:"\ud83e\uddfe Request Body",id:"-request-body",level:3},{value:"\u2705 Respuesta exitosa",id:"-respuesta-exitosa",level:3},{value:"\ud83d\udd11 Endpoint: <code>POST /auth/solicitar-reset</code>",id:"-endpoint-post-authsolicitar-reset",level:2},{value:"\ud83e\uddfe Request Body",id:"-request-body-1",level:3},{value:"\u2705 Respuesta",id:"-respuesta",level:3},{value:"\ud83d\udd10 Endpoint: <code>POST /auth/confirmar-reset</code>",id:"-endpoint-post-authconfirmar-reset",level:2},{value:"\ud83e\uddfe Request Body",id:"-request-body-2",level:3},{value:"\u2705 Respuesta",id:"-respuesta-1",level:3},{value:"\ud83d\udee0\ufe0f Notas t\xe9cnicas",id:"\ufe0f-notas-t\xe9cnicas",level:2}];function a(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.header,{children:(0,o.jsx)(r.h1,{id:"controlador-de-autenticaci\xf3n",children:"Controlador de Autenticaci\xf3n"})}),"\n",(0,o.jsxs)(r.p,{children:["Este controlador gestiona el proceso de ",(0,o.jsx)(r.strong,{children:"inicio de sesi\xf3n"})," y ",(0,o.jsx)(r.strong,{children:"restablecimiento de contrase\xf1a"})," para los usuarios registrados. Forma parte del m\xf3dulo de autenticaci\xf3n de la aplicaci\xf3n y expone tres endpoints principales:"]}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"POST /auth/login"}),": Iniciar sesi\xf3n."]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"POST /auth/solicitar-reset"}),": Solicitar restablecimiento de contrase\xf1a."]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"POST /auth/confirmar-reset"}),": Confirmar nueva contrase\xf1a usando token."]}),"\n"]}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h2,{id:"-ubicaci\xf3n",children:"\ud83d\udd0d Ubicaci\xf3n"}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.code,{children:"src/controllers/log.controller.ts"})}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsxs)(r.h2,{id:"-endpoint-post-authlogin",children:["\ud83d\udccc Endpoint: ",(0,o.jsx)(r.code,{children:"POST /auth/login"})]}),"\n",(0,o.jsx)(r.p,{children:"Autentica a un usuario a partir de sus credenciales. Si son v\xe1lidas, devuelve un token JWT y los datos del usuario."}),"\n",(0,o.jsx)(r.h3,{id:"-request-body",children:"\ud83e\uddfe Request Body"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-json",children:'{\r\n  "correo": "usuario@ejemplo.com",\r\n  "password": "123456"\r\n}\n'})}),"\n",(0,o.jsxs)(r.table,{children:[(0,o.jsx)(r.thead,{children:(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.th,{children:"Campo"}),(0,o.jsx)(r.th,{children:"Tipo"}),(0,o.jsx)(r.th,{children:"Descripci\xf3n"})]})}),(0,o.jsxs)(r.tbody,{children:[(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"correo"}),(0,o.jsx)(r.td,{children:"string"}),(0,o.jsx)(r.td,{children:"Correo electr\xf3nico del usuario."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"password"}),(0,o.jsx)(r.td,{children:"string"}),(0,o.jsx)(r.td,{children:"Contrase\xf1a del usuario."})]})]})]}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h3,{id:"-respuesta-exitosa",children:"\u2705 Respuesta exitosa"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-json",children:'{\r\n  "token": "eyJhbGciOiJIUzI1NiIsInR...",\r\n  "requiereCompletarPerfil": false,\r\n  "user": {\r\n    "idUsuario": 1,\r\n    "username": "ximena_dev",\r\n    "correo": "ximena@empresa.com",\r\n    "rol": "admin",\r\n    "tipoUsuario": "empresarial",\r\n    "rolEquipo": "editor",\r\n    "perfilCompleto": true,\r\n    "empresaId": 101\r\n  }\r\n}\n'})}),"\n",(0,o.jsxs)(r.table,{children:[(0,o.jsx)(r.thead,{children:(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.th,{children:"Campo"}),(0,o.jsx)(r.th,{children:"Tipo"}),(0,o.jsx)(r.th,{children:"Descripci\xf3n"})]})}),(0,o.jsxs)(r.tbody,{children:[(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"token"}),(0,o.jsx)(r.td,{children:"string"}),(0,o.jsx)(r.td,{children:"Token JWT v\xe1lido para autenticaci\xf3n."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"requiereCompletarPerfil"}),(0,o.jsx)(r.td,{children:"boolean"}),(0,o.jsx)(r.td,{children:"Indica si falta informaci\xf3n para completar el perfil."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"user"}),(0,o.jsx)(r.td,{children:"object"}),(0,o.jsx)(r.td,{children:"Informaci\xf3n detallada del usuario autenticado."})]})]})]}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsxs)(r.h2,{id:"-endpoint-post-authsolicitar-reset",children:["\ud83d\udd11 Endpoint: ",(0,o.jsx)(r.code,{children:"POST /auth/solicitar-reset"})]}),"\n",(0,o.jsx)(r.p,{children:"Env\xeda un correo con un token temporal para restablecer la contrase\xf1a."}),"\n",(0,o.jsx)(r.h3,{id:"-request-body-1",children:"\ud83e\uddfe Request Body"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-json",children:'{\r\n  "correo": "usuario@ejemplo.com"\r\n}\n'})}),"\n",(0,o.jsxs)(r.table,{children:[(0,o.jsx)(r.thead,{children:(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.th,{children:"Campo"}),(0,o.jsx)(r.th,{children:"Tipo"}),(0,o.jsx)(r.th,{children:"Descripci\xf3n"})]})}),(0,o.jsx)(r.tbody,{children:(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"correo"}),(0,o.jsx)(r.td,{children:"string"}),(0,o.jsx)(r.td,{children:"Correo del usuario registrado."})]})})]}),"\n",(0,o.jsx)(r.h3,{id:"-respuesta",children:"\u2705 Respuesta"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-json",children:'{\r\n  "mensaje": "Se ha enviado un enlace de restablecimiento a tu correo."\r\n}\n'})}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsxs)(r.h2,{id:"-endpoint-post-authconfirmar-reset",children:["\ud83d\udd10 Endpoint: ",(0,o.jsx)(r.code,{children:"POST /auth/confirmar-reset"})]}),"\n",(0,o.jsx)(r.p,{children:"Confirma el cambio de contrase\xf1a utilizando el token enviado al correo."}),"\n",(0,o.jsx)(r.h3,{id:"-request-body-2",children:"\ud83e\uddfe Request Body"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-json",children:'{\r\n  "token": "ABC123TOKEN",\r\n  "nuevaContrasena": "nuevaSegura123"\r\n}\n'})}),"\n",(0,o.jsxs)(r.table,{children:[(0,o.jsx)(r.thead,{children:(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.th,{children:"Campo"}),(0,o.jsx)(r.th,{children:"Tipo"}),(0,o.jsx)(r.th,{children:"Descripci\xf3n"})]})}),(0,o.jsxs)(r.tbody,{children:[(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"token"}),(0,o.jsx)(r.td,{children:"string"}),(0,o.jsx)(r.td,{children:"Token recibido por correo."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"nuevaContrasena"}),(0,o.jsx)(r.td,{children:"string"}),(0,o.jsx)(r.td,{children:"Nueva contrase\xf1a elegida por el usuario."})]})]})]}),"\n",(0,o.jsx)(r.h3,{id:"-respuesta-1",children:"\u2705 Respuesta"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-json",children:'{\r\n  "mensaje": "La contrase\xf1a ha sido restablecida con \xe9xito."\r\n}\n'})}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h2,{id:"\ufe0f-notas-t\xe9cnicas",children:"\ud83d\udee0\ufe0f Notas t\xe9cnicas"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"validarCredenciales"})," se encarga de validar correo y contrase\xf1a."]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"LogService"})," implementa la l\xf3gica de recuperaci\xf3n y cambio de contrase\xf1a."]}),"\n",(0,o.jsxs)(r.li,{children:["Todas las rutas usan decoradores de ",(0,o.jsx)(r.code,{children:"tsoa"})," (",(0,o.jsx)(r.code,{children:"@Post"}),", ",(0,o.jsx)(r.code,{children:"@Body"}),", ",(0,o.jsx)(r.code,{children:"@Route"}),", etc.) para generar documentaci\xf3n Swagger autom\xe1ticamente."]}),"\n",(0,o.jsxs)(r.li,{children:["El token JWT debe ser enviado en futuras peticiones protegidas usando el header ",(0,o.jsx)(r.code,{children:"Authorization: Bearer <token>"}),"."]}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>t,x:()=>c});var s=n(6540);const o={},i=s.createContext(o);function t(e){const r=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),s.createElement(i.Provider,{value:r},e.children)}}}]);