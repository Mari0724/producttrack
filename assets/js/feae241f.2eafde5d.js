"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9917],{8453:(e,i,n)=>{n.d(i,{R:()=>s,x:()=>a});var r=n(6540);const o={},c=r.createContext(o);function s(e){const i=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),r.createElement(c.Provider,{value:i},e.children)}},9522:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>t,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"backend/services/norificaciones/comentarioProductos.service","title":"Servicio de Notificaciones por Comentario de Producto","description":"Este servicio se encarga de notificar a todos los miembros de una empresa cuando un producto recibe un nuevo comentario.","source":"@site/docs/backend/services/norificaciones/comentarioProducto.sercive.md","sourceDirName":"backend/services/norificaciones","slug":"/backend/services/norificaciones/comentarioProductos.service","permalink":"/producttrack/docs/backend/services/norificaciones/comentarioProductos.service","draft":false,"unlisted":false,"editUrl":"https://github.com/Mari0724/producttrack/docs/backend/services/norificaciones/comentarioProducto.sercive.md","tags":[],"version":"current","frontMatter":{"id":"comentarioProductos.service","title":"Servicio de Notificaciones por Comentario de Producto","sidebar_label":"Comentario Producto"},"sidebar":"tutorialSidebar","previous":{"title":"Actualizaci\xf3n","permalink":"/producttrack/docs/backend/services/norificaciones/actualizacion.service"},"next":{"title":"Marcar Leida","permalink":"/producttrack/docs/backend/services/norificaciones/marcarLeidaService"}}');var o=n(4848),c=n(8453);const s={id:"comentarioProductos.service",title:"Servicio de Notificaciones por Comentario de Producto",sidebar_label:"Comentario Producto"},a=void 0,t={},d=[{value:"\ud83d\udd0d Ubicaci\xf3n",id:"-ubicaci\xf3n",level:2},{value:"\ud83d\udce6 Dependencias utilizadas",id:"-dependencias-utilizadas",level:2},{value:"\ud83e\udde9 Funci\xf3n: <code>notificarComentarioProducto(idComentario: number)</code>",id:"-funci\xf3n-notificarcomentarioproductoidcomentario-number",level:2},{value:"Par\xe1metros",id:"par\xe1metros",level:3},{value:"\ud83d\udcdc Flujo de ejecuci\xf3n",id:"-flujo-de-ejecuci\xf3n",level:3},{value:"Ejemplo de uso",id:"ejemplo-de-uso",level:3},{value:"\ud83e\udde0 Observaciones",id:"-observaciones",level:2}];function l(e){const i={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(i.p,{children:["Este servicio se encarga de ",(0,o.jsx)(i.strong,{children:"notificar a todos los miembros de una empresa"})," cuando un producto recibe un nuevo comentario."]}),"\n",(0,o.jsx)(i.hr,{}),"\n",(0,o.jsx)(i.h2,{id:"-ubicaci\xf3n",children:"\ud83d\udd0d Ubicaci\xf3n"}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.code,{children:"src/services/notificaciones/comentarioProductos.service.ts"})}),"\n",(0,o.jsx)(i.hr,{}),"\n",(0,o.jsx)(i.h2,{id:"-dependencias-utilizadas",children:"\ud83d\udce6 Dependencias utilizadas"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.a,{href:"/producttrack/docs/backend/utils/prismaClient",children:(0,o.jsx)(i.code,{children:"prismaClient"})})," \u2014 Cliente de Prisma configurado para interactuar con la base de datos."]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.a,{href:"https://www.prisma.io/docs/",children:(0,o.jsx)(i.code,{children:"TipoNotificacion"})})," \u2014 Enumeraci\xf3n generada por Prisma para definir tipos de notificaciones."]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.a,{href:"/producttrack/docs/backend/utils/notificaciones/preferenciasNotificaciones",children:(0,o.jsx)(i.code,{children:"puedeNotificar"})})," \u2014 Funci\xf3n que verifica si un usuario tiene habilitado recibir cierto tipo de notificaci\xf3n."]}),"\n"]}),"\n",(0,o.jsx)(i.hr,{}),"\n",(0,o.jsxs)(i.h2,{id:"-funci\xf3n-notificarcomentarioproductoidcomentario-number",children:["\ud83e\udde9 Funci\xf3n: ",(0,o.jsx)(i.code,{children:"notificarComentarioProducto(idComentario: number)"})]}),"\n",(0,o.jsx)(i.p,{children:"Env\xeda una notificaci\xf3n a todos los miembros de la empresa propietaria de un producto que ha recibido un nuevo comentario."}),"\n",(0,o.jsx)(i.h3,{id:"par\xe1metros",children:"Par\xe1metros"}),"\n",(0,o.jsxs)(i.table,{children:[(0,o.jsx)(i.thead,{children:(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.th,{children:"Nombre"}),(0,o.jsx)(i.th,{children:"Tipo"}),(0,o.jsx)(i.th,{children:"Descripci\xf3n"})]})}),(0,o.jsx)(i.tbody,{children:(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:(0,o.jsx)(i.code,{children:"idComentario"})}),(0,o.jsx)(i.td,{children:(0,o.jsx)(i.code,{children:"number"})}),(0,o.jsx)(i.td,{children:"ID \xfanico del comentario que activ\xf3 la notificaci\xf3n."})]})})]}),"\n",(0,o.jsx)(i.hr,{}),"\n",(0,o.jsx)(i.h3,{id:"-flujo-de-ejecuci\xf3n",children:"\ud83d\udcdc Flujo de ejecuci\xf3n"}),"\n",(0,o.jsxs)(i.ol,{children:["\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.strong,{children:"Obtener el comentario y sus relaciones"}),(0,o.jsx)(i.br,{}),"\n","Busca en la base de datos el comentario por su ",(0,o.jsx)(i.code,{children:"idComentario"}),", incluyendo el producto al que pertenece y el usuario due\xf1o del producto."]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.strong,{children:"Validar existencia"}),(0,o.jsx)(i.br,{}),"\n","Si no existe el comentario, el producto o el usuario propietario, se emite una advertencia y se detiene el proceso."]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.strong,{children:"Validar pertenencia a empresa"}),(0,o.jsx)(i.br,{}),"\n","Si el usuario propietario del producto no pertenece a una empresa (",(0,o.jsx)(i.code,{children:"empresaId"}),"), se detiene el proceso."]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.strong,{children:"Obtener miembros de la empresa"}),(0,o.jsx)(i.br,{}),"\n","Busca todos los usuarios que pertenecen a la misma empresa."]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.strong,{children:"Construir mensaje y t\xedtulo de la notificaci\xf3n"}),(0,o.jsx)(i.br,{}),"\n","Ejemplo:"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{children:'\r\nT\xedtulo: Nuevo comentario en producto: Producto X\r\nMensaje: Se ha comentado el producto "Producto X": "Texto del comentario"\r\n\n'})}),"\n",(0,o.jsxs)(i.ol,{start:"6",children:["\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.strong,{children:"Filtrar miembros que pueden recibir la notificaci\xf3n"}),(0,o.jsx)(i.br,{}),"\n","Usa la funci\xf3n ",(0,o.jsx)(i.code,{children:"puedeNotificar"})," para verificar si cada miembro tiene activado el tipo de notificaci\xf3n ",(0,o.jsx)(i.code,{children:"COMENTARIO_EQUIPO"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.strong,{children:"Enviar notificaciones"}),(0,o.jsx)(i.br,{}),"\n","Inserta todas las notificaciones en la base de datos mediante ",(0,o.jsx)(i.code,{children:"prisma.notificaciones.createMany"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(i.hr,{}),"\n",(0,o.jsx)(i.h3,{id:"ejemplo-de-uso",children:"Ejemplo de uso"}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-ts",children:"await notificarComentarioProducto(45);\n"})}),"\n",(0,o.jsxs)(i.p,{children:["Este ejemplo enviar\xe1 la notificaci\xf3n a los miembros de la empresa propietaria del producto comentado con ID de comentario ",(0,o.jsx)(i.code,{children:"45"}),"."]}),"\n",(0,o.jsx)(i.hr,{}),"\n",(0,o.jsx)(i.h2,{id:"-observaciones",children:"\ud83e\udde0 Observaciones"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsx)(i.li,{children:"Si no se encuentran miembros en la empresa, no se enviar\xe1n notificaciones."}),"\n",(0,o.jsxs)(i.li,{children:["Usa ",(0,o.jsx)(i.code,{children:"puedeNotificar"})," para respetar las preferencias individuales de notificaci\xf3n."]}),"\n",(0,o.jsx)(i.li,{children:"La relaci\xf3n entre comentario \u2192 producto \u2192 usuario es clave para identificar a los destinatarios."}),"\n"]}),"\n",(0,o.jsx)(i.hr,{})]})}function u(e={}){const{wrapper:i}={...(0,c.R)(),...e.components};return i?(0,o.jsx)(i,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}}}]);