"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[288],{5930:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>c,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"backend/controllers/user.controller","title":"UserController","description":"Este archivo contiene el controlador para la entidad Usuario. Se encarga de manejar las peticiones HTTP relacionadas con los usuarios, incluyendo creaci\xf3n, consulta, actualizaci\xf3n, eliminaci\xf3n, cambio de contrase\xf1a y reactivaci\xf3n. Tambi\xe9n maneja la obtenci\xf3n de datos empresariales asociados a usuarios con rol EQUIPO.","source":"@site/docs/backend/controllers/user.controller.md","sourceDirName":"backend/controllers","slug":"/backend/controllers/user.controller","permalink":"/producttrack/docs/backend/controllers/user.controller","draft":false,"unlisted":false,"editUrl":"https://github.com/Mari0724/producttrack/docs/backend/controllers/user.controller.md","tags":[],"version":"current","frontMatter":{"id":"user.controller","title":"UserController","sidebar_label":"User"},"sidebar":"tutorialSidebar","previous":{"title":"Productos","permalink":"/producttrack/docs/backend/controllers/productos.controller"},"next":{"title":"\ud83d\udce6 Backend","permalink":"/producttrack/docs/backend/"}}');var i=r(4848),o=r(8453);const c={id:"user.controller",title:"UserController",sidebar_label:"User"},a="UserController",d={},l=[{value:"\ud83d\udd0d Ubicaci\xf3n",id:"-ubicaci\xf3n",level:2},{value:"\u2705 Responsabilidades",id:"-responsabilidades",level:2},{value:"\u2699\ufe0f Funciones principales",id:"\ufe0f-funciones-principales",level:2},{value:"<code>getAll()</code>",id:"getall",level:3},{value:"<code>getById(id: string)</code>",id:"getbyidid-string",level:3},{value:"<code>create()</code>",id:"create",level:3},{value:"<code>getEmpresaByIdController(id: number)</code>",id:"getempresabyidcontrollerid-number",level:3},{value:"<code>cambiarContrasena()</code>",id:"cambiarcontrasena",level:3},{value:"<code>updateUsuario(id: number, body: Partial&lt;UserDTO&gt;)</code>",id:"updateusuarioid-number-body-partialuserdto",level:3},{value:"<code>reactivarUsuario(id: number)</code>",id:"reactivarusuarioid-number",level:3},{value:"<code>deleteUsuario(id: number)</code>",id:"deleteusuarioid-number",level:3},{value:"\ud83e\udde0 Notas adicionales",id:"-notas-adicionales",level:2}];function t(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"usercontroller",children:"UserController"})}),"\n",(0,i.jsxs)(n.p,{children:["Este archivo contiene el controlador para la entidad ",(0,i.jsx)(n.code,{children:"Usuario"}),". Se encarga de manejar las peticiones HTTP relacionadas con los usuarios, incluyendo creaci\xf3n, consulta, actualizaci\xf3n, eliminaci\xf3n, cambio de contrase\xf1a y reactivaci\xf3n. Tambi\xe9n maneja la obtenci\xf3n de datos empresariales asociados a usuarios con rol ",(0,i.jsx)(n.code,{children:"EQUIPO"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-ubicaci\xf3n",children:"\ud83d\udd0d Ubicaci\xf3n"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"src/controllers/user.controller.ts"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-responsabilidades",children:"\u2705 Responsabilidades"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Manejar las solicitudes entrantes relacionadas con usuarios."}),"\n",(0,i.jsxs)(n.li,{children:["Validar datos de entrada con Zod (",(0,i.jsx)(n.code,{children:"userSchema"}),") y validaciones personalizadas."]}),"\n",(0,i.jsxs)(n.li,{children:["Delegar operaciones al servicio de usuario (",(0,i.jsx)(n.code,{children:"user.service.ts"}),")."]}),"\n",(0,i.jsx)(n.li,{children:"Devolver respuestas apropiadas seg\xfan el resultado de cada operaci\xf3n."}),"\n",(0,i.jsx)(n.li,{children:"Manejo de errores con c\xf3digos HTTP adecuados."}),"\n",(0,i.jsxs)(n.li,{children:["Proteger rutas espec\xedficas con seguridad JWT (",(0,i.jsx)(n.code,{children:'@Security("jwt")'}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\ufe0f-funciones-principales",children:"\u2699\ufe0f Funciones principales"}),"\n",(0,i.jsx)(n.h3,{id:"getall",children:(0,i.jsx)(n.code,{children:"getAll()"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'@Get("/")\r\npublic async getAll(...): Promise<any>\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"M\xe9todo HTTP:"})," ",(0,i.jsx)(n.code,{children:"GET /usuarios"}),"\r\n",(0,i.jsx)(n.strong,{children:"Descripci\xf3n:"})," Retorna todos los usuarios que cumplan con los filtros enviados por query (",(0,i.jsx)(n.code,{children:"username"}),", ",(0,i.jsx)(n.code,{children:"correo"}),", ",(0,i.jsx)(n.code,{children:"estado"}),", ",(0,i.jsx)(n.code,{children:"tipo"}),", ",(0,i.jsx)(n.code,{children:"rol"}),", etc.).\r\n",(0,i.jsx)(n.strong,{children:"Notas:"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Soporta m\xfaltiples filtros opcionales."}),"\n",(0,i.jsx)(n.li,{children:"No requiere autenticaci\xf3n."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"getbyidid-string",children:(0,i.jsx)(n.code,{children:"getById(id: string)"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'@Get("/{id}")\r\npublic async getById(id: string): Promise<any>\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"M\xe9todo HTTP:"})," ",(0,i.jsx)(n.code,{children:"GET /usuarios/{id}"}),"\r\n",(0,i.jsx)(n.strong,{children:"Descripci\xf3n:"})," Retorna los datos del usuario con el ID especificado.\r\n",(0,i.jsx)(n.strong,{children:"Notas:"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Valida que el ID sea un n\xfamero positivo."}),"\n",(0,i.jsx)(n.li,{children:"Retorna 404 si el usuario no existe."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"create",children:(0,i.jsx)(n.code,{children:"create()"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'@Post("/")\r\npublic async create(@Body() requestBody: UserDTO): Promise<ResponseMessageWithToken>\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"M\xe9todo HTTP:"})," ",(0,i.jsx)(n.code,{children:"POST /usuarios"}),"\r\n",(0,i.jsx)(n.strong,{children:"Descripci\xf3n:"})," Crea un nuevo usuario a partir de los datos enviados.\r\n",(0,i.jsx)(n.strong,{children:"Validaciones especiales:"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Usa ",(0,i.jsx)(n.code,{children:"zodValidate"})," con ",(0,i.jsx)(n.code,{children:"userSchema"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Si el rol es ",(0,i.jsx)(n.code,{children:"EQUIPO"}),", ",(0,i.jsx)(n.code,{children:"empresaId"})," es obligatorio."]}),"\n",(0,i.jsxs)(n.li,{children:["Si no es ",(0,i.jsx)(n.code,{children:"EQUIPO"}),", ",(0,i.jsx)(n.code,{children:"empresaId"})," no debe enviarse.\r\n",(0,i.jsx)(n.strong,{children:"Respuesta:"})]}),"\n",(0,i.jsx)(n.li,{children:"Devuelve un token JWT si la creaci\xf3n es exitosa."}),"\n",(0,i.jsx)(n.li,{children:"Devuelve mensajes detallados en caso de error."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"getempresabyidcontrollerid-number",children:(0,i.jsx)(n.code,{children:"getEmpresaByIdController(id: number)"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'@Get("/empresa/{id}")\r\n@Security("jwt")\r\npublic async getEmpresaByIdController(@Path() id: number): Promise<any>\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"M\xe9todo HTTP:"})," ",(0,i.jsx)(n.code,{children:"GET /usuarios/empresa/{id}"}),"\r\n",(0,i.jsx)(n.strong,{children:"Descripci\xf3n:"})," Devuelve informaci\xf3n de una empresa asociada al usuario con ID proporcionado.\r\n",(0,i.jsx)(n.strong,{children:"Notas:"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Protegido con JWT."}),"\n",(0,i.jsx)(n.li,{children:"Retorna campos clave de la empresa (nombre, NIT, correo, direcci\xf3n, etc.)."}),"\n",(0,i.jsx)(n.li,{children:"Devuelve 404 si la empresa no es encontrada."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"cambiarcontrasena",children:(0,i.jsx)(n.code,{children:"cambiarContrasena()"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'@Put("/cambiarContrasena")\r\npublic async cambiarContrasena(@Body() body: ChangePasswordDTO): Promise<{ message: string }>\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"M\xe9todo HTTP:"})," ",(0,i.jsx)(n.code,{children:"PUT /usuarios/cambiarContrasena"}),"\r\n",(0,i.jsx)(n.strong,{children:"Descripci\xf3n:"})," Cambia la contrase\xf1a de un usuario.\r\n",(0,i.jsx)(n.strong,{children:"Notas:"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Requiere ",(0,i.jsx)(n.code,{children:"id"}),", ",(0,i.jsx)(n.code,{children:"currentPassword"})," y ",(0,i.jsx)(n.code,{children:"newPassword"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Devuelve mensajes informando \xe9xito o errores."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"updateusuarioid-number-body-partialuserdto",children:(0,i.jsx)(n.code,{children:"updateUsuario(id: number, body: Partial<UserDTO>)"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'@Put("/{id}")\r\npublic async updateUsuario(@Path() id: number, @Body() body: Partial<UserDTO>): Promise<ResponseMessage>\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"M\xe9todo HTTP:"})," ",(0,i.jsx)(n.code,{children:"PUT /usuarios/{id}"}),"\r\n",(0,i.jsx)(n.strong,{children:"Descripci\xf3n:"})," Actualiza los datos de un usuario.\r\n",(0,i.jsx)(n.strong,{children:"Validaciones:"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Si el nuevo rol no es ",(0,i.jsx)(n.code,{children:"EQUIPO"}),", no debe enviarse ",(0,i.jsx)(n.code,{children:"empresaId"}),".\r\n",(0,i.jsx)(n.strong,{children:"Manejo de errores:"})]}),"\n",(0,i.jsx)(n.li,{children:"404 si el usuario no existe."}),"\n",(0,i.jsx)(n.li,{children:"400 si hay conflictos de validaci\xf3n."}),"\n",(0,i.jsx)(n.li,{children:"500 si ocurre un error interno."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"reactivarusuarioid-number",children:(0,i.jsx)(n.code,{children:"reactivarUsuario(id: number)"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'@Put("/{id}/reactivar")\r\npublic async reactivarUsuario(@Path() id: number): Promise<ResponseMessage>\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"M\xe9todo HTTP:"})," ",(0,i.jsx)(n.code,{children:"PUT /usuarios/{id}/reactivar"}),"\r\n",(0,i.jsx)(n.strong,{children:"Descripci\xf3n:"})," Reactiva un usuario previamente eliminado o inactivo.\r\n",(0,i.jsx)(n.strong,{children:"Notas:"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Devuelve 200 si fue exitoso."}),"\n",(0,i.jsx)(n.li,{children:"400 si ya estaba activo."}),"\n",(0,i.jsx)(n.li,{children:"404 si no fue encontrado."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"deleteusuarioid-number",children:(0,i.jsx)(n.code,{children:"deleteUsuario(id: number)"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'@Delete("/{id}")\r\npublic async deleteUsuario(@Path() id: number): Promise<ResponseMessage>\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"M\xe9todo HTTP:"})," ",(0,i.jsx)(n.code,{children:"DELETE /usuarios/{id}"}),"\r\n",(0,i.jsx)(n.strong,{children:"Descripci\xf3n:"})," Realiza una eliminaci\xf3n l\xf3gica (soft delete) del usuario.\r\n",(0,i.jsx)(n.strong,{children:"Respuesta:"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"200 si la eliminaci\xf3n fue exitosa."}),"\n",(0,i.jsx)(n.li,{children:"404 si el usuario no fue encontrado."}),"\n",(0,i.jsx)(n.li,{children:"500 si hay errores del servidor."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-notas-adicionales",children:"\ud83e\udde0 Notas adicionales"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Usa ",(0,i.jsx)(n.code,{children:"TSOA"})," para definir rutas, tipos, seguridad y documentaci\xf3n Swagger."]}),"\n",(0,i.jsxs)(n.li,{children:["Todas las funciones llaman a servicios definidos en ",(0,i.jsx)(n.code,{children:"user.service.ts"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Manejo centralizado de errores y validaciones."}),"\n",(0,i.jsx)(n.li,{children:"Separa responsabilidades entre controlador y l\xf3gica de negocio."}),"\n",(0,i.jsxs)(n.li,{children:["Provee respuestas estructuradas (",(0,i.jsx)(n.code,{children:"ResponseMessage"}),", ",(0,i.jsx)(n.code,{children:"ResponseMessageWithToken"}),")."]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>a});var s=r(6540);const i={},o=s.createContext(i);function c(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);