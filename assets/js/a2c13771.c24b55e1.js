"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5412],{6919:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>o,contentTitle:()=>c,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"backend/services/user.service","title":"Servicio Users","description":"Este archivo contiene la l\xf3gica del servicio relacionada con la gesti\xf3n de usuarios, incluyendo operaciones CRUD, validaciones de negocio y manejo de autenticaci\xf3n.","source":"@site/docs/backend/services/user.service.md","sourceDirName":"backend/services","slug":"/backend/services/user.service","permalink":"/producttrack/docs/backend/services/user.service","draft":false,"unlisted":false,"editUrl":"https://github.com/Mari0724/producttrack/docs/backend/services/user.service.md","tags":[],"version":"current","frontMatter":{"id":"user.service","title":"Servicio Users","sidebar_label":"User Service"},"sidebar":"tutorialSidebar","previous":{"title":"Token Service","permalink":"/producttrack/docs/backend/services/token.service"},"next":{"title":"Servidor","permalink":"/producttrack/docs/backend/Servidor"}}');var n=s(4848),d=s(8453);const l={id:"user.service",title:"Servicio Users",sidebar_label:"User Service"},c="User Service",o={},a=[{value:"\ud83d\udd0d Ubicaci\xf3n",id:"-ubicaci\xf3n",level:2},{value:"\ud83d\udce6 Dependencias",id:"-dependencias",level:2},{value:"\ud83d\udd0d <code>getAllUsers(filters: Partial&lt;UserDTO&gt;)</code>",id:"-getallusersfilters-partialuserdto",level:2},{value:"Par\xe1metros:",id:"par\xe1metros",level:3},{value:"Retorno:",id:"retorno",level:3},{value:"\ud83d\udd0d <code>getUserById(id: number)</code>",id:"-getuserbyidid-number",level:2},{value:"Par\xe1metros:",id:"par\xe1metros-1",level:3},{value:"Retorno:",id:"retorno-1",level:3},{value:"\ud83c\udd95 <code>createUser(data: UserDTO)</code>",id:"-createuserdata-userdto",level:2},{value:"Reglas de negocio:",id:"reglas-de-negocio",level:3},{value:"Proceso:",id:"proceso",level:3},{value:"Par\xe1metros:",id:"par\xe1metros-2",level:3},{value:"Retorno:",id:"retorno-2",level:3},{value:"\ud83c\udd99 <code>updateUser(id: number, data: Partial&lt;UserDTO&gt;)</code>",id:"-updateuserid-number-data-partialuserdto",level:2},{value:"Reglas:",id:"reglas",level:3},{value:"Par\xe1metros:",id:"par\xe1metros-3",level:3},{value:"Retorno:",id:"retorno-3",level:3},{value:"\u2716\ufe0f <code>deleteUser(id: number)</code>",id:"\ufe0f-deleteuserid-number",level:2},{value:"Proceso:",id:"proceso-1",level:3},{value:"Par\xe1metros:",id:"par\xe1metros-4",level:3},{value:"Retorno:",id:"retorno-4",level:3},{value:"\ud83e\udde0 Observaciones:",id:"-observaciones",level:2}];function t(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",ul:"ul",...(0,d.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"user-service",children:"User Service"})}),"\n",(0,n.jsx)(r.p,{children:"Este archivo contiene la l\xf3gica del servicio relacionada con la gesti\xf3n de usuarios, incluyendo operaciones CRUD, validaciones de negocio y manejo de autenticaci\xf3n."}),"\n",(0,n.jsx)(r.hr,{}),"\n",(0,n.jsx)(r.h2,{id:"-ubicaci\xf3n",children:"\ud83d\udd0d Ubicaci\xf3n"}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.code,{children:"src/services/user.service.ts"})}),"\n",(0,n.jsx)(r.hr,{}),"\n",(0,n.jsx)(r.h2,{id:"-dependencias",children:"\ud83d\udce6 Dependencias"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"prisma"}),": ORM para acceso a la base de datos."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"cloudinary"}),": Gesti\xf3n de im\xe1genes (perfil de usuario)."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"bcrypt"}),": Encriptaci\xf3n de contrase\xf1as."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"jsonwebtoken"}),": Generaci\xf3n de tokens JWT."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"UserDTO"}),": Tipo de datos del usuario."]}),"\n"]}),"\n",(0,n.jsx)(r.hr,{}),"\n",(0,n.jsxs)(r.h2,{id:"-getallusersfilters-partialuserdto",children:["\ud83d\udd0d ",(0,n.jsx)(r.code,{children:"getAllUsers(filters: Partial<UserDTO>)"})]}),"\n",(0,n.jsx)(r.p,{children:"Obtiene todos los usuarios que coincidan con los filtros proporcionados."}),"\n",(0,n.jsx)(r.h3,{id:"par\xe1metros",children:"Par\xe1metros:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"filters"}),": Objeto parcial del DTO con campos como ",(0,n.jsx)(r.code,{children:"username"}),", ",(0,n.jsx)(r.code,{children:"correo"}),", ",(0,n.jsx)(r.code,{children:"telefono"}),", ",(0,n.jsx)(r.code,{children:"estado"}),", ",(0,n.jsx)(r.code,{children:"rol"}),", etc."]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"retorno",children:"Retorno:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Lista de usuarios que cumplen con los criterios."}),"\n"]}),"\n",(0,n.jsx)(r.hr,{}),"\n",(0,n.jsxs)(r.h2,{id:"-getuserbyidid-number",children:["\ud83d\udd0d ",(0,n.jsx)(r.code,{children:"getUserById(id: number)"})]}),"\n",(0,n.jsxs)(r.p,{children:["Obtiene un usuario por su ",(0,n.jsx)(r.code,{children:"idUsuario"}),"."]}),"\n",(0,n.jsx)(r.h3,{id:"par\xe1metros-1",children:"Par\xe1metros:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"id"}),": ID del usuario."]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"retorno-1",children:"Retorno:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Objeto del usuario si existe, ",(0,n.jsx)(r.code,{children:"null"})," si no."]}),"\n"]}),"\n",(0,n.jsx)(r.hr,{}),"\n",(0,n.jsxs)(r.h2,{id:"-createuserdata-userdto",children:["\ud83c\udd95 ",(0,n.jsx)(r.code,{children:"createUser(data: UserDTO)"})]}),"\n",(0,n.jsx)(r.p,{children:"Crea un nuevo usuario, aplicando validaciones seg\xfan el tipo y rol."}),"\n",(0,n.jsx)(r.h3,{id:"reglas-de-negocio",children:"Reglas de negocio:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Si ",(0,n.jsx)(r.code,{children:"rol"})," es ",(0,n.jsx)(r.code,{children:"USUARIO"}),", debe especificarse ",(0,n.jsx)(r.code,{children:"tipoUsuario"}),"."]}),"\n",(0,n.jsxs)(r.li,{children:["Si ",(0,n.jsx)(r.code,{children:"rol"})," es ",(0,n.jsx)(r.code,{children:"EQUIPO"}),", debe tener un ",(0,n.jsx)(r.code,{children:"empresaId"})," v\xe1lido que corresponda a un usuario de tipo ",(0,n.jsx)(r.code,{children:"EMPRESARIAL"}),"."]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"proceso",children:"Proceso:"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsx)(r.li,{children:"Valida reglas de negocio."}),"\n",(0,n.jsx)(r.li,{children:"Hashea la contrase\xf1a."}),"\n",(0,n.jsx)(r.li,{children:"Construye manualmente el objeto de usuario."}),"\n",(0,n.jsx)(r.li,{children:"Guarda en la base de datos."}),"\n",(0,n.jsx)(r.li,{children:"Genera un JWT con 24 horas de expiraci\xf3n."}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"par\xe1metros-2",children:"Par\xe1metros:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"data"}),": Objeto completo ",(0,n.jsx)(r.code,{children:"UserDTO"}),"."]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"retorno-2",children:"Retorno:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Objeto ",(0,n.jsx)(r.code,{children:"{ user, token }"}),"."]}),"\n"]}),"\n",(0,n.jsx)(r.hr,{}),"\n",(0,n.jsxs)(r.h2,{id:"-updateuserid-number-data-partialuserdto",children:["\ud83c\udd99 ",(0,n.jsx)(r.code,{children:"updateUser(id: number, data: Partial<UserDTO>)"})]}),"\n",(0,n.jsx)(r.p,{children:"Actualiza un usuario existente, con reglas espec\xedficas."}),"\n",(0,n.jsx)(r.h3,{id:"reglas",children:"Reglas:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["No se puede cambiar el ",(0,n.jsx)(r.code,{children:"rol"})," del usuario."]}),"\n",(0,n.jsx)(r.li,{children:"Si se env\xeda una nueva contrase\xf1a, ser\xe1 encriptada."}),"\n",(0,n.jsxs)(r.li,{children:["Si se actualiza ",(0,n.jsx)(r.code,{children:"fotoPerfil"}),", elimina la antigua imagen de Cloudinary."]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"par\xe1metros-3",children:"Par\xe1metros:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"id"}),": ID del usuario."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"data"}),": Campos a actualizar (parcial del DTO)."]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"retorno-3",children:"Retorno:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Objeto del usuario actualizado."}),"\n"]}),"\n",(0,n.jsx)(r.hr,{}),"\n",(0,n.jsxs)(r.h2,{id:"\ufe0f-deleteuserid-number",children:["\u2716\ufe0f ",(0,n.jsx)(r.code,{children:"deleteUser(id: number)"})]}),"\n",(0,n.jsx)(r.p,{children:"Realiza una eliminaci\xf3n l\xf3gica del usuario."}),"\n",(0,n.jsx)(r.h3,{id:"proceso-1",children:"Proceso:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Cambia ",(0,n.jsx)(r.code,{children:"estado"})," a ",(0,n.jsx)(r.code,{children:'"inactivo"'}),"."]}),"\n",(0,n.jsxs)(r.li,{children:["Establece ",(0,n.jsx)(r.code,{children:"deletedAt"})," y ",(0,n.jsx)(r.code,{children:"updatedAt"}),"."]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"par\xe1metros-4",children:"Par\xe1metros:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"id"}),": ID del usuario."]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"retorno-4",children:"Retorno:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Objeto del usuario marcado como eliminado."}),"\n"]}),"\n",(0,n.jsx)(r.hr,{}),"\n",(0,n.jsx)(r.h2,{id:"-observaciones",children:"\ud83e\udde0 Observaciones:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"La l\xf3gica est\xe1 fuertemente ligada al tipo de rol para validar negocio."}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"fotoPerfil"})," se gestiona con Cloudinary, eliminando la imagen anterior al actualizar."]}),"\n",(0,n.jsxs)(r.li,{children:["El servicio evita eliminaciones f\xedsicas, optando por una estrategia l\xf3gica (",(0,n.jsx)(r.code,{children:"deletedAt"}),", ",(0,n.jsx)(r.code,{children:"estado"}),")."]}),"\n"]})]})}function u(e={}){const{wrapper:r}={...(0,d.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(t,{...e})}):t(e)}},8453:(e,r,s)=>{s.d(r,{R:()=>l,x:()=>c});var i=s(6540);const n={},d=i.createContext(n);function l(e){const r=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),i.createElement(d.Provider,{value:r},e.children)}}}]);