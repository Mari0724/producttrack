"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9610],{1215:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>t});const c=JSON.parse('{"id":"backend/services/norificaciones/reposicionService","title":"Servicio - Notificar Reposici\xf3n Recomendada","description":"Este servicio env\xeda notificaciones de reposici\xf3n recomendada cuando un producto cae por debajo de su cantidad m\xednima recomendada de stock.","source":"@site/docs/backend/services/norificaciones/reposicion.service.md","sourceDirName":"backend/services/norificaciones","slug":"/backend/services/norificaciones/reposicionService","permalink":"/producttrack/docs/backend/services/norificaciones/reposicionService","draft":false,"unlisted":false,"editUrl":"https://github.com/Mari0724/producttrack/docs/backend/services/norificaciones/reposicion.service.md","tags":[],"version":"current","frontMatter":{"id":"reposicionService","title":"Servicio - Notificar Reposici\xf3n Recomendada","sidebar_label":"Reposicion"},"sidebar":"tutorialSidebar","previous":{"title":"Producto Vencido","permalink":"/producttrack/docs/backend/services/norificaciones/productoVencidoService"},"next":{"title":"StockBajo","permalink":"/producttrack/docs/backend/services/norificaciones/stockBajoService"}}');var r=n(4848),s=n(8453);const o={id:"reposicionService",title:"Servicio - Notificar Reposici\xf3n Recomendada",sidebar_label:"Reposicion"},a=void 0,d={},t=[{value:"\ud83d\udd0d Ubicaci\xf3n",id:"-ubicaci\xf3n",level:2},{value:"\ud83d\udce6 Dependencias utilizadas",id:"-dependencias-utilizadas",level:2},{value:"\ud83d\udd0d Descripci\xf3n",id:"-descripci\xf3n",level:2},{value:"\ud83d\udee0\ufe0f L\xf3gica clave",id:"\ufe0f-l\xf3gica-clave",level:2},{value:"\ud83d\udccc Par\xe1metros",id:"-par\xe1metros",level:2},{value:"\ud83d\udce4 Retorno",id:"-retorno",level:2},{value:"\ud83d\udcce Notas",id:"-notas",level:2}];function l(e){const i={a:"a",code:"code",h2:"h2",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.p,{children:["Este servicio env\xeda ",(0,r.jsx)(i.strong,{children:"notificaciones de reposici\xf3n recomendada"})," cuando un producto cae por debajo de su ",(0,r.jsx)(i.strong,{children:"cantidad m\xednima recomendada"})," de stock."]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"-ubicaci\xf3n",children:"\ud83d\udd0d Ubicaci\xf3n"}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.code,{children:"src/services/notificaciones/reposicion.service.ts"})}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"-dependencias-utilizadas",children:"\ud83d\udce6 Dependencias utilizadas"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-ts",children:"import prisma from '../../utils/prismaClient';\r\nimport { TipoNotificacion, productos as Producto } from '@prisma/client';\r\nimport { puedeNotificar } from '../../utils/notificaciones/preferenciasNotificaciones';\n"})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.code,{children:"prisma"})})," \u2192 Cliente Prisma configurado en ",(0,r.jsx)(i.a,{href:"/producttrack/docs/backend/utils/prismaClient",children:(0,r.jsx)(i.code,{children:"utils/prismaClient.ts"})}),", para interactuar con la base de datos."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.code,{children:"TipoNotificacion"})})," \u2192 Enumeraci\xf3n con los tipos de notificaci\xf3n."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.code,{children:"Producto"})})," \u2192 Tipo correspondiente al modelo ",(0,r.jsx)(i.code,{children:"productos"})," en Prisma."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.code,{children:"puedeNotificar"})})," \u2192 Funci\xf3n que valida si un usuario tiene habilitado recibir un tipo de notificaci\xf3n."]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"-descripci\xf3n",children:"\ud83d\udd0d Descripci\xf3n"}),"\n",(0,r.jsxs)(i.p,{children:["La funci\xf3n ",(0,r.jsx)(i.code,{children:"notificarReposicionRecomendada"}),":"]}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsxs)(i.li,{children:["Obtiene los ",(0,r.jsx)(i.strong,{children:"recordatorios de stock m\xednimo"})," (",(0,r.jsx)(i.code,{children:"recorStock"}),"), filtrando opcionalmente por una lista de productos."]}),"\n",(0,r.jsxs)(i.li,{children:["Comprueba si la cantidad actual est\xe1 ",(0,r.jsx)(i.strong,{children:"por debajo del m\xednimo recomendado"}),", pero ",(0,r.jsx)(i.strong,{children:"por encima del umbral cr\xedtico"}),"."]}),"\n",(0,r.jsxs)(i.li,{children:["Si se cumplen las condiciones:","\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Usuarios individuales:"})," se env\xeda la notificaci\xf3n solo al propietario."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Usuarios empresariales:"})," se env\xeda a todos los miembros de la empresa."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["Antes de enviar cualquier notificaci\xf3n, se respeta la configuraci\xf3n de ",(0,r.jsx)(i.strong,{children:"preferencias de notificaci\xf3n"}),"."]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"\ufe0f-l\xf3gica-clave",children:"\ud83d\udee0\ufe0f L\xf3gica clave"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-ts",children:"const umbralCritico = Math.min(8, Math.floor(cantidadMinima / 8));\r\nif (cantidadActual <= umbralCritico) return;\r\nif (cantidadActual >= cantidadMinima) return;\r\n\r\n// Crear notificaci\xf3n si puedeNotificar(...)\n"})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Umbral cr\xedtico:"})," evita notificar en casos de stock extremadamente bajo (posible notificaci\xf3n previa)."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Chequeos de cantidad:"})," evita alertas innecesarias cuando el stock est\xe1 igual o por encima del m\xednimo."]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"-par\xe1metros",children:"\ud83d\udccc Par\xe1metros"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Par\xe1metro"}),(0,r.jsx)(i.th,{children:"Tipo"}),(0,r.jsx)(i.th,{children:"Obligatorio"}),(0,r.jsx)(i.th,{children:"Descripci\xf3n"})]})}),(0,r.jsx)(i.tbody,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"productosOpcionales"})}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"Producto[]"})}),(0,r.jsx)(i.td,{children:"No"}),(0,r.jsx)(i.td,{children:"Lista de productos a evaluar. Si no se pasa, se revisan todos en la BD."})]})})]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"-retorno",children:"\ud83d\udce4 Retorno"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Tipo:"})," ",(0,r.jsx)(i.code,{children:"Promise<void>"})]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Efecto:"})," Registra en la base de datos notificaciones de tipo ",(0,r.jsx)(i.code,{children:"REPOSICION_RECOMENDADA"}),"."]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"-notas",children:"\ud83d\udcce Notas"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["El servicio diferencia entre ",(0,r.jsx)(i.strong,{children:"usuarios individuales"})," y ",(0,r.jsx)(i.strong,{children:"empresariales"}),"."]}),"\n",(0,r.jsxs)(i.li,{children:["Solo se notifica a quienes tengan activa la preferencia ",(0,r.jsx)(i.code,{children:"REPOSICION_RECOMENDADA"}),"."]}),"\n",(0,r.jsx)(i.li,{children:"La fecha de env\xedo se registra para trazabilidad."}),"\n"]}),"\n",(0,r.jsx)(i.hr,{})]})}function h(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>o,x:()=>a});var c=n(6540);const r={},s=c.createContext(r);function o(e){const i=c.useContext(s);return c.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),c.createElement(s.Provider,{value:i},e.children)}}}]);